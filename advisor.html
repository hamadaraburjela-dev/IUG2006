<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ููุตุฉ ุงูุฅุฑุดุงุฏ ุงูุฃูุงุฏููู</title>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet"/>
  <style>
    :root{
      --primary:#4f46e5; --primary-dark:#3730a3; --accent:#06b6d4;
      --bg:#f9fafb; --card:#ffffff; --text:#111827; --muted:#6b7280;
      --success:#22c55e; --radius:14px; --shadow:0 8px 30px rgba(0,0,0,.08);
    }
    *{box-sizing:border-box;margin:0;padding:0}
    body{
      font-family:'Cairo',sans-serif;
      background:linear-gradient(135deg,var(--primary),var(--accent));
      min-height:100vh;display:flex;align-items:center;justify-content:center;padding:24px;
    }
    .container{width:100%;max-width:980px;background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);padding:36px;animation:fade .4s ease}
    header{text-align:center;margin-bottom:8px}
    header h1{color:var(--primary);font-size:2.2rem;margin-bottom:10px}
    header p{color:var(--muted)}
    .hero{
      display:grid;grid-template-columns:1fr;gap:16px;text-align:center;margin-top:12px
    }
    .hero .icon{font-size:56px}
    .features{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:14px;margin:22px 0}
    .feature{background:#f3f4f6;border-radius:12px;padding:14px}
    .feature h3{color:var(--primary);margin-bottom:6px}
    .btn{display:inline-block;border:none;border-radius:12px;padding:14px 22px;font-size:1rem;color:#fff;background:var(--success);cursor:pointer;transition:.2s}
    .btn:hover{background:#15803d}
    /* Quiz */
    .progress-wrap{margin:8px 0 16px}
    .progress-bar{height:10px;background:#e5e7eb;border-radius:12px;overflow:hidden}
    .progress{height:100%;background:var(--primary);width:0%}
    .section-title{font-weight:700;color:var(--primary);margin:10px 0}
    .q-card{background:#fff;border:1px solid #eee;border-radius:12px;padding:16px;margin-bottom:10px}
    .q-text{font-weight:600;margin-bottom:10px}
    .likert{display:flex;gap:8px;flex-wrap:wrap}
    .chip{
      flex:1;min-width:70px;text-align:center;padding:10px;border-radius:12px;border:2px solid #e5e7eb;cursor:pointer;background:#fff;transition:.2s
    }
    .chip:hover{border-color:var(--primary);background:#f5f3ff}
    .chip.selected{border-color:var(--primary);background:#ede9fe}
    .nav{display:flex;gap:10px;margin-top:10px}
    .btn-nav{flex:1;background:var(--primary)}
    .btn-nav:hover{background:var(--primary-dark)}
    .btn-submit{background:var(--success)}
    .results h2{text-align:center;color:var(--primary);margin-bottom:8px}
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(230px,1fr));gap:12px}
    .result{background:#f3f4f6;border-radius:12px;padding:12px}
    .result .tag{display:inline-block;background:#fff;border:1px solid #e5e7eb;border-radius:999px;padding:4px 10px;font-size:.85rem;margin-top:6px}
    .muted{color:var(--muted);font-size:.95rem}
    .intro-hide{display:none}
    @keyframes fade{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}
    @media(min-width:900px){
      .hero{grid-template-columns:1.1fr .9fr;text-align:start;align-items:center}
      .hero-visual{background:linear-gradient(135deg,#eef2ff,#cffafe);border-radius:16px;min-height:220px;display:flex;align-items:center;justify-content:center;font-size:100px}
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- ุตูุญุฉ ุงูุจุฏุงูุฉ -->
    <div id="intro">
      <div class="hero">
        <div>
          <header>
            <h1>ููุตุฉ ุงูุฅุฑุดุงุฏ ุงูุฃูุงุฏููู</h1>
            <p>ุงุฎุชุจุงุฑ ุงุญุชุฑุงูู ูุจูู ุนูู ูููุฐุฌ RIASEC + ููู ููููุฉุ ูุงูุชุฑุงุญ ุชุฎุตุตุงุช ููุงุฆูุฉ ูู.</p>
          </header>
          <div class="features">
            <div class="feature">
              <h3>๐ฏ ูุจูู ุนูู ุนูู</h3>
              <p class="muted">RIASEC ูููุซูู ุนูู ูุทุงู ูุงุณุนุ ูุชุณุชุฎุฏูู ุฃุฏูุงุช ุฑุณููุฉ ูุซู O*NET.</p>
            </div>
            <div class="feature">
              <h3>๐งญ 42 ุณุคุงู ุฏููู</h3>
              <p class="muted">ูููุณ 6 ูููู ูุธูููุฉ + 3 ููู ููููุฉ ุชุคุซุฑ ูู ุงููุฑุงุฑ.</p>
            </div>
            <div class="feature">
              <h3>๐ ุชูุตูุงุช ูุงุถุญุฉ</h3>
              <p class="muted">ููุธูุฑ ุฃุนูู ุงูุดูุฑุงุช (ุงูููุฏุงุช) ูุน ุชุฎุตุตุงุช ููุงุณุจุฉ ูุชูุณูุฑ ููุฌุฒ.</p>
            </div>
          </div>
          <button id="btnStart" class="btn">ุงุจุฏุฃ ุงูุงุณุชุดุงุฑุฉ</button>
        </div>
        <div class="hero-visual">๐</div>
      </div>
    </div>

    <!-- ุงูุงุณุชุจูุงู -->
    <div id="quizSection" class="intro-hide">
      <div class="progress-wrap">
        <div class="progress-bar"><div id="progress" class="progress"></div></div>
        <div class="muted" id="progressText"></div>
      </div>

      <div id="pageTitle" class="section-title"></div>
      <div id="questionsWrap"></div>

      <div class="nav">
        <button id="btnPrev" class="btn btn-nav">ุงูุณุงุจู</button>
        <button id="btnNext" class="btn btn-nav">ุงูุชุงูู</button>
        <button id="btnSubmit" class="btn btn-submit intro-hide">ุฅุธูุงุฑ ุงููุชุงุฆุฌ</button>
      </div>
    </div>

    <!-- ุงููุชุงุฆุฌ -->
    <div id="results" class="intro-hide">
      <h2>ูุชุงุฆุฌ ุงูุงุณุชุดุงุฑุฉ</h2>
      <p class="muted" id="summaryLine"></p>
      <div id="recommendations" class="grid" style="margin-top:10px"></div>
      <div style="margin-top:12px;display:flex;gap:10px">
        <button id="btnRestart" class="btn">๐ ุจุฏุก ูู ุฌุฏูุฏ</button>
      </div>
      <p class="muted" style="margin-top:10px">ุชูุจูู: ูุฐุง ุงูุงุณุชุจูุงู ุฅุฑุดุงุฏู ูููุณ ุชุดุฎูุตุงู ููุณูุงู. ูููุถููู ููุงูุดุฉ ุงููุชุงุฆุฌ ูุน ุงููุฑุดุฏ ุงูุฃูุงุฏููู.</p>
    </div>
  </div>

  <script>
    /* ======================
       1) ุชุนุฑูู ุงูุจููู
       ====================== */
    // ุฃุณุฆูุฉ RIASEC (36): 6 ููู ุจุนุฏ. ูููุงุณ 1 (ูุง ุฃููู ุฅุทูุงูุงู) ุฅูู 5 (ุฃููู ุฌุฏุงู)
    const RIASEC_ITEMS = [
      // R - ูุงูุนู Realistic: ุฃูุดุทุฉ ุนูููุฉ/ููุฏุงููุฉ/ุฃุฏูุงุช
      {t:"ุฃุณุชูุชุน ุจุงูุฃุนูุงู ุงููุฏููุฉ ูุงุณุชุฎุฏุงู ุงูุฃุฏูุงุช.", d:"R"},
      {t:"ุฃูุถู ุงูููุงู ุงูุนูููุฉ ุนูู ุงูุนูู ุงูููุชุจู ุงูุทููู.", d:"R"},
      {t:"ุฃููุถููู ุจูุฆุงุช ุนูู ููุฏุงููุฉ ุฃู ุฎุงุฑุฌูุฉ.", d:"R"},
      {t:"ุฃุฌุฏ ุชุฑููุจ/ุฅุตูุงุญ ุงูุฃุดูุงุก ููุชุนุงู.", d:"R"},
      {t:"ุฃูุถู ุงูุชุนููู ุจุงูุชุฌุฑุจุฉ ุงููุจุงุดุฑุฉ.", d:"R"},
      {t:"ุฃุฑุชุงุญ ูู ุงูุฃุนูุงู ุงูุชู ุชุทูุจ ูุดุงุทุงู ุจุฏููุงู.", d:"R"},
      // I - ุชุญูููู Investigative: ุชุญููู/ุจุญุซ/ุนูู
      {t:"ุฃุณุชูุชุน ุจุญู ุงููุณุงุฆู ุงููุนููุฏุฉ.", d:"I"},
      {t:"ุฃุญุจ ุชุญููู ุงูุจูุงูุงุช ูุงูุชุดุงู ุงูุฃููุงุท.", d:"I"},
      {t:"ุฃููู ููุจุญุซ ูุงูุชุนููู ูุจู ุงุชุฎุงุฐ ุงููุฑุงุฑ.", d:"I"},
      {t:"ุงูููุถูุนุงุช ุงูุนูููุฉ/ุงูุฑูุงุถูุฉ ุชุซูุฑ ุงูุชูุงูู.", d:"I"},
      {t:"ุฃุณุชูุชุน ุจุชุฌุฑุจุฉ ุฃููุงุฑ ููุฑุถููุงุช ุฌุฏูุฏุฉ.", d:"I"},
      {t:"ุฃููุถูู ููุงู ุชุชุทููุจ ุชูููุฑุงู ููุฏูุงู.", d:"I"},
      // A - ููู Artistic: ุฅุจุฏุงุน/ุชุตููู/ุชุนุจูุฑ
      {t:"ุฃููู ููุชุนุจูุฑ ุงูุฅุจุฏุงุนู (ูุชุงุจุฉ/ุฑุณู/ุชุตููู).", d:"A"},
      {t:"ุฃุณุชูุชุน ุจุงุจุชูุงุฑ ุญููู ุบูุฑ ุชูููุฏูุฉ.", d:"A"},
      {t:"ุฃููุถููู ุนููุงู ูููุญูู ุญุฑูุฉ ูููุฉ.", d:"A"},
      {t:"ุฃูุชู ุจุฌูุงููุงุช ุงูุนุฑุถ ูุงูุชุตููู.", d:"A"},
      {t:"ุฃุญุจ ุตูุงุนุฉ ุงููุญุชูู ุงููุฑุฆู ุฃู ุงูุณุฑุฏู.", d:"A"},
      {t:"ุฃุฎุชุงุฑ ููุงูุงู ุชุณูุญ ูู ุจุงูุชุฌุฑุจุฉ ูุงูุงุจุชูุงุฑ.", d:"A"},
      // S - ุงุฌุชูุงุนู Social: ูุณุงุนุฏุฉ/ุชุนููู/ุชูุงุตู
      {t:"ุฃุณุชูุชุน ุจูุณุงุนุฏุฉ ุงูุขุฎุฑูู ุนูู ุงูุชุนููู ุฃู ุงูุชุทููุฑ.", d:"S"},
      {t:"ุฃูุถูู ุงูุนูู ุงูุฐู ูุชูุงุตู ูุน ุงููุงุณ ุจุดูู ูุจุงุดุฑ.", d:"S"},
      {t:"ุฃุณุชูุฏ ุทุงูุชู ูู ุงูุนูู ุถูู ูุฑู ูุชูุฌูููุง.", d:"S"},
      {t:"ุฃูุชูู ุงูุฅุตุบุงุก ูุชูููู ุงุญุชูุงุฌุงุช ุงูุขุฎุฑูู.", d:"S"},
      {t:"ุฃุญุจ ุชูุฏูู ุงูุฅุฑุดุงุฏ ุฃู ุงูุฏุนู ููุฃุดุฎุงุต.", d:"S"},
      {t:"ุฃููู ููุฃุฏูุงุฑ ุงูุชู ููุง ุฃุซุฑ ูุฌุชูุนู ูุงุถุญ.", d:"S"},
      // E - ูุจุงุฏุฑ Enterprising: ููุงุฏุฉ/ูุจูุนุงุช/ุฃุนูุงู
      {t:"ุฃุญุจ ููุงุฏุฉ ุงููุดุงุฑูุน ูุงุชุฎุงุฐ ุงููุฑุงุฑุงุช.", d:"E"},
      {t:"ุฃุณุชูุชุน ุจุงูุชูุงูุถ ูุงูุฅููุงุน ูุจูุน ุงูุฃููุงุฑ.", d:"E"},
      {t:"ุฃุทูุญ ูุจูุงุก ุนูู/ูุดุฑูุน ุฎุงุต ุจู.", d:"E"},
      {t:"ุฃุณุชูุชุน ุจุฃูุฏุงู ุทููุญุฉ ูููุงูุณุฉ.", d:"E"},
      {t:"ุฃููู ูุฃุฏูุงุฑ ุชูุธูู ุงูููุงุฑุฏ ูุชูุฒูุนูุง.", d:"E"},
      {t:"ุฃูุชูุน ุจุณุฑุนุฉ ุจููุฑุฉ ุฌููุฏุฉ ูุฃุฏูุน ุงููุฑูู ูุชูููุฐูุง.", d:"E"},
      // C - ุชูููุฏู Conventional: ุชูุธูู/ุชูุงุตูู/ุฃูุธูุฉ
      {t:"ุฃุณุชูุชุน ุจุชูุธูู ุงููุนูููุงุช ูุชุจููุจูุง.", d:"C"},
      {t:"ุฃูุถูู ุจูุฆุฉ ุนูู ุฐุงุช ุฅุฌุฑุงุกุงุช ูุงุถุญุฉ ูุซุงุจุชุฉ.", d:"C"},
      {t:"ุฃูุชูู ุงูุชุนุงูู ูุน ุงูุฌุฏุงูู/ุงููููุงุช ุจุฏูุฉ.", d:"C"},
      {t:"ุฃููู ูุงุชุจุงุน ุงูููุงุนุฏ ูุถูุงู ุงูุฌูุฏุฉ.", d:"C"},
      {t:"ุฃุณุชูุชุน ุจุงูููุงู ุงูุชู ุชุชุทูุจ ุฏูุฉ ูุชูุงุตูู.", d:"C"},
      {t:"ุฃูุถู ุฅููุงุก ุงูุฃุนูุงู ุฎุทูุฉ ุจุฎุทูุฉ ููู ุฎุทุฉ.", d:"C"},
    ];

    // ููู ููููุฉ (6): ุชุถุจุท ุชุฑุชูุจ ุงููุชุงุฆุฌ (ุฑุงุชุจ/ุงุณุชูุฑุงุฑ/ุฎุฏูุฉ ูุฌุชูุน)
    const VALUE_ITEMS = [
      {t:"ุฃูุถู ูุธููุฉ ุฐุงุช ุฏุฎู ูุฑุชูุน ุญุชู ูู ูุงูุช ุฃูู ูุชุนุฉ.", k:"salary"},
      {t:"ุฃูุฏูู ุงูุงุณุชูุฑุงุฑ ุงููุธููู ุนูู ุงููุบุงูุฑุฉ.", k:"stability"},
      {t:"ุฃุจุญุซ ุนู ุนูู ูู ุฃุซุฑ ูุฌุชูุนู ูุจุงุดุฑ.", k:"altruism"},
      {t:"ุฃูุถู ุงูุชุนููู ุงููุณุชูุฑ ุญุชู ูู ุชุทูุจ ุฌูุฏุงู ุฅุถุงููุงู.", k:"growth"},
      {t:"ุฃูุถู ูุฑููุฉ ุงูููุช ุนูู ุฏูุงู ุซุงุจุช ูุตุงุฑู.", k:"flexibility"},
      {t:"ุฃูุถู ูุถูุญ ุงููุณุงุฑ ุงููุธููู ุนูู ุชุบููุฑ ุงูููุงู ุงููุชูุฑุฑ.", k:"clarity"},
    ];

    // ุชูุณูู ุงูุตูุญุงุช: 7 ุฃุณุฆูุฉ ูู ุงูุตูุญุฉ (6 ุตูุญุงุช RIASEC) + ุตูุญุฉ ููู (ุฃุฎูุฑุฉ)
    const PAGE_SIZE = 7;
    const TOTAL_R_ITEMS = RIASEC_ITEMS.length; // 36
    const TOTAL_V_ITEMS = VALUE_ITEMS.length;  // 6
    const TOTAL_ITEMS = TOTAL_R_ITEMS + TOTAL_V_ITEMS; // 42
    const R_PAGES = Math.ceil(TOTAL_R_ITEMS / PAGE_SIZE); // 6
    const TOTAL_PAGES = R_PAGES + 1; // + ุตูุญุฉ ุงูููู

    // ุงูุชุฎุตุตุงุช ูููุงุนุฏ ุงูุฑุจุท ุชูุฑุฃ ุฃุนูู ุดูุฑุงุช RIASEC + ุงูููู
    const MAJORS = [
      {id:'cs', name:'ููุฏุณุฉ/ุนููู ุงูุญุงุณูุจ', codes:['I','C','R'], note:'ุชุญููู ูุฐูุงุก ุงุตุทูุงุนู/ุจุฑูุฌุฉ/ุฃูุธูุฉ'},
      {id:'ai', name:'ุงูุฐูุงุก ุงูุงุตุทูุงุนู ูุนููู ุงูุจูุงูุงุช', codes:['I','C'], note:'ุชุญููู ุจูุงูุงุชุ ุชุนูู ุขููุ ุจุญุซ ูุชุทููุฑ'},
      {id:'civil', name:'ุงูููุฏุณุฉ ุงููุฏููุฉ', codes:['R','I','C'], note:'ููุฏุงูู + ุญุณุงุจุงุช ูุชุตููู ูุชูููุฐ'},
      {id:'me', name:'ุงูููุฏุณุฉ ุงููููุงููููุฉ', codes:['R','I'], note:'ุชุตููู ูููุงูููู ูููุธู ูุงุฏูุฉ'},
      {id:'ee', name:'ููุฏุณุฉ ููุฑุจุงุฆูุฉ/ุงุชุตุงูุงุช', codes:['I','R','C'], note:'ุฅููุชุฑูููุงุชุ ูุธู ุงุชุตุงูุงุชุ ุชุญูู'},
      {id:'arch', name:'ุงูููุฏุณุฉ ุงููุนูุงุฑูุฉ', codes:['A','R','I'], note:'ุฅุจุฏุงุน ุจุตุฑู + ูุชุทูุจุงุช ุชูููุฉ'},
      {id:'design', name:'ุงูุชุตููู ุงูุฌุฑุงูููู/ุงูููุชุฌ', codes:['A'], note:'ูููุฉ ุจุตุฑูุฉุ ุชุฌุฑุจุฉ ูุณุชุฎุฏูุ ูุญุชูู'},
      {id:'med', name:'ุงูุทุจ ุงูุจุดุฑู', codes:['S','I'], note:'ูุณุงุนุฏุฉ ุจุดุฑ + ูุนุฑูุฉ ุนูููุฉ ุนูููุฉ'},
      {id:'pharm', name:'ุงูุตูุฏูุฉ', codes:['I','C','S'], note:'ุนููู ุฏููู + ุงูุชุฒุงู ูุนุงููุฑ'},
      {id:'nursing', name:'ุงูุชูุฑูุถ/ุงูุนููู ุงูุตุญูุฉ', codes:['S','C'], note:'ุฑุนุงูุฉ ูุจุงุดุฑุฉ + ุจุฑูุชููููุงุช ุซุงุจุชุฉ'},
      {id:'law', name:'ุงููุงููู', codes:['S','E','C'], note:'ุชูุงุตู/ุญุฌุฌ + ุงูุชุฒุงู ุฃูุธูุฉ'},
      {id:'biz', name:'ุฅุฏุงุฑุฉ ุงูุฃุนูุงู', codes:['E','S','C'], note:'ููุงุฏุฉ/ุชูุธูู/ุนูููุงุช'},
      {id:'mkt', name:'ุงูุชุณููู/ุงููุจูุนุงุช', codes:['E','A','S'], note:'ุฅููุงุนุ ุณุฑุฏ ูุตุตูุ ููู ุงูุนููุงุก'},
      {id:'acc', name:'ูุญุงุณุจุฉ/ุชูููู', codes:['C','I'], note:'ุฏูุฉ ุนุงููุฉุ ุฃูุธูุฉ ูุชูุงุฑูุฑ'},
      {id:'edu', name:'ุงูุชุฑุจูุฉ ูุงูุชุนููู', codes:['S','A'], note:'ุชุนููู ูุชูุงุตู ูุฅุจุฏุงุน ูู ุงูุดุฑุญ'}
    ];

    /* ======================
       2) ุนูุงุตุฑ ุงููุงุฌูุฉ
       ====================== */
    const intro = document.getElementById('intro');
    const quizSection = document.getElementById('quizSection');
    const resultsView = document.getElementById('results');
    const btnStart = document.getElementById('btnStart');
    const btnPrev = document.getElementById('btnPrev');
    const btnNext = document.getElementById('btnNext');
    const btnSubmit = document.getElementById('btnSubmit');
    const progress = document.getElementById('progress');
    const progressText = document.getElementById('progressText');
    const pageTitle = document.getElementById('pageTitle');
    const questionsWrap = document.getElementById('questionsWrap');
    const btnRestart = document.getElementById('btnRestart');
    const recommendations = document.getElementById('recommendations');
    const summaryLine = document.getElementById('summaryLine');

    /* ======================
       3) ุญุงูุฉ ุงูุงุฎุชุจุงุฑ
       ====================== */
    let page = 0; // 0..TOTAL_PAGES-1
    const responses = {}; // idx -> 1..5
    const values = {};    // key -> 1..5

    /* ======================
       4) ูุธุงุฆู ุงููุณุงุนุฏุฉ
       ====================== */
    function show(el){ el.classList.remove('intro-hide'); }
    function hide(el){ el.classList.add('intro-hide'); }
    function clamp(v,min,max){ return Math.max(min, Math.min(max, v)); }

    function renderPage(){
      questionsWrap.innerHTML = '';
      const isValuePage = (page === TOTAL_PAGES - 1);

      // ุนููุงู ุงููุณู
      pageTitle.textContent = isValuePage ? 'ุงูููู ุงูููููุฉ' : `ูููู ุงูุนูู (RIASEC) โ ุงูุตูุญุฉ ${page + 1} ูู ${TOTAL_PAGES - 1}`;

      // ูุตุฏุฑ ุงูุฃุณุฆูุฉ ูู ูุฐู ุงูุตูุญุฉ
      let items = [];
      if(!isValuePage){
        const start = page * PAGE_SIZE;
        items = RIASEC_ITEMS.slice(start, start + PAGE_SIZE);
      }else{
        items = VALUE_ITEMS;
      }

      // ุจูุงุก ุงูุจุทุงูุงุช
      items.forEach((item, idxOnPage) => {
        const globalIdx = isValuePage ? (`val_${item.k}`) : (page * PAGE_SIZE + idxOnPage);
        const card = document.createElement('div');
        card.className = 'q-card';

        const q = document.createElement('div');
        q.className = 'q-text';
        q.textContent = isValuePage ? item.t : `${globalIdx+1}. ${item.t}`;
        card.appendChild(q);

        const likert = document.createElement('div');
        likert.className = 'likert';

        const labels = ["1 ูุง ุฃููู", "2", "3 ูุญุงูุฏ", "4", "5 ุฃููู ุฌุฏุงู"];
        for(let v=1; v<=5; v++){
          const chip = document.createElement('div');
          chip.className = 'chip';
          chip.textContent = labels[v-1];
          const selected = isValuePage
            ? (values[item.k] === v)
            : (responses[globalIdx] === v);
          if(selected) chip.classList.add('selected');
          chip.onclick = () => {
            if(isValuePage){
              values[item.k] = v;
            }else{
              responses[globalIdx] = v;
            }
            renderPage(); // ุฅุนุงุฏุฉ ุงูุฑุณู ูุชุญุฏูุซ ุงูุชุญุฏูุฏ
          };
          likert.appendChild(chip);
        }

        card.appendChild(likert);
        questionsWrap.appendChild(card);
      });

      // ุดุฑูุท ุงูุชูุฏู
      const answeredCount = Object.keys(responses).length + Object.keys(values).length;
      const pct = Math.round( (answeredCount / TOTAL_ITEMS) * 100 );
      progress.style.width = pct + '%';
      progressText.textContent = `ุฃุฌุจุช ุนูู ${answeredCount} ูู ${TOTAL_ITEMS} (${pct}ูช)`;

      // ุฃุฒุฑุงุฑ
      btnPrev.disabled = page === 0;
      btnNext.classList.remove('intro-hide');
      btnSubmit.classList.add('intro-hide');
      if(page === TOTAL_PAGES - 1){
        btnNext.classList.add('intro-hide');
        btnSubmit.classList.remove('intro-hide');
      }
    }

    function scoreRIASEC(){
      const scores = {R:0,I:0,A:0,S:0,E:0,C:0};
      for(let i=0;i<RIASEC_ITEMS.length;i++){
        const item = RIASEC_ITEMS[i];
        const v = responses[i] || 0;
        scores[item.d] += v;
      }
      return scores;
    }

    function topCodes(scores){
      const arr = Object.entries(scores).sort((a,b)=>b[1]-a[1]);
      return arr.slice(0,3).map(([k])=>k); // ุฃุนูู 3
    }

    function rankMajors(scores){
      const codes = topCodes(scores);
      const weights = {salary:(values.salary||3)-3, stability:(values.stability||3)-3, altruism:(values.altruism||3)-3};
      // ุชุญููู -2..+2 ุฅูู ูุถุงุนูุงุช ุจุณูุทุฉ
      function codeMatchScore(m){
        // ุชุดุงุจู ุงูุดูุฑุงุช
        let s = 0;
        m.codes.forEach((c, idx)=>{
          s += (scores[c]||0) * (idx===0?1.0:idx===1?0.7:0.5);
        });
        // ุชุนุฏููุงุช ุงูููู (ุชูุฑูุจูุฉ)
        if(['med','nursing','edu'].includes(m.id)) s += (weights.altruism*2);
        if(['acc','pharm','civil','ee'].includes(m.id)) s += (weights.stability*1.5);
        if(['biz','mkt','ai','cs'].includes(m.id)) s += (weights.salary*1.5);
        return s;
      }
      const ranked = MAJORS
        .map(m => ({...m, s: codeMatchScore(m)}))
        .sort((a,b)=>b.s-a.s);
      return {codes, ranked};
    }

    function codeToLabel(c){
      return {R:'ูุงูุนู', I:'ุชุญูููู/ุจุญุซู', A:'ููู/ุฅุจุฏุงุนู', S:'ุงุฌุชูุงุนู', E:'ูุจุงุฏุฑ/ููุงุฏู', C:'ุชูููุฏู/ููุธูู'}[c] || c;
    }

    function showResults(){
      // ุชุญูู ุจุณูุท: ุฌููุน ุงูุฃุณุฆูุฉ ูุฌุงุจุฉ
      const needed = TOTAL_ITEMS;
      const got = Object.keys(responses).length + Object.keys(values).length;
      if(got < needed){
        alert('ูุฑุฌู ุฅููุงู ุฌููุน ุงูุฃุณุฆูุฉ ูุจู ุนุฑุถ ุงููุชุงุฆุฌ.');
        return;
      }
      const scores = scoreRIASEC();
      const {codes, ranked} = rankMajors(scores);

      // ููุฎุต
      const codeStr = codes.map(codeToLabel).join(' โข ');
      summaryLine.textContent = `ุฃุนูู ูููู ูุฏูู: ${codeStr}`;

      // ุชูุตูุงุช
      recommendations.innerHTML = '';
      ranked.slice(0,6).forEach(m=>{
        const div = document.createElement('div');
        div.className = 'result';
        div.innerHTML = `
          <div style="font-weight:700">${m.name}</div>
          <div class="muted">${m.note}</div>
          <div class="tag">ุฑููุฒ ูุฑุชุจุทุฉ: ${m.codes.join('-')}</div>
        `;
        recommendations.appendChild(div);
      });

      hide(quizSection);
      show(resultsView);
      window.scrollTo({top:0,behavior:'smooth'});
    }

    /* ======================
       5) ุฃุญุฏุงุซ
       ====================== */
    btnStart.onclick = () => { hide(intro); show(quizSection); renderPage(); };
    btnPrev.onclick = () => { page = clamp(page-1, 0, TOTAL_PAGES-1); renderPage(); };
    btnNext.onclick = () => { page = clamp(page+1, 0, TOTAL_PAGES-1); renderPage(); };
    btnSubmit.onclick = showResults;
    btnRestart.onclick = () => {
      page = 0; for(const k in responses) delete responses[k];
      for(const k in values) delete values[k];
      hide(resultsView); show(intro); window.scrollTo({top:0,behavior:'smooth'});
    };
  </script>
</body>
</html>
