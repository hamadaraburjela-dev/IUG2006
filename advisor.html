<!DOCTYPE html>

<html dir="rtl" lang="ar">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>ุฌุงูุนุฉ ุงููุนุฑูุฉ | ุงูุฅุฑุดุงุฏ ุงูุฃูุงุฏููู</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&amp;display=swap" rel="stylesheet"/>
<link crossorigin="anonymous" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" referrerpolicy="no-referrer" rel="stylesheet"/>
<!-- ูุนุชูุฏ ุนูู ููุท ุงููููุน ุงูุฃุณุงุณู ุฅู ููุฌุฏ -->
<link href="assets/css/main.css" rel="stylesheet"/>
<style>
    :root {
      --pri:#0a3d62; --pri2:#1e5799; --bg:#f4f8fb; --ok:#16a34a; --warn:#f59e0b; --bad:#ef4444;
      --card:#ffffff; --muted:#6b7280; --chip:#eef6ff;
    }
    body { background:var(--bg); font-family: "Cairo", system-ui, -apple-system, Segoe UI, Roboto, Arial; }
    .container { max-width: 1100px; margin: 20px auto 80px; padding: 0 16px; }
    .page-header { display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:14px; }
    .page-header h1 { font-size: 26px; margin:0; color:var(--pri); }
    .sub { color:var(--muted); font-size:13px; }
    .chip { display:inline-flex; align-items:center; gap:6px; background:var(--chip); border:1px solid rgba(10,61,98,.12); padding:4px 10px; border-radius:999px; font-size:12px; color:#0a3d62; }

    .card { background:var(--card); border:1px solid rgba(10,61,98,.08); border-radius:16px; box-shadow:0 6px 18px rgba(10,61,98,.06); padding:16px; }
    .grid { display:grid; gap:12px; }
    .cols-2 { grid-template-columns:repeat(2,minmax(0,1fr)); }
    @media (max-width: 900px){ .cols-2{ grid-template-columns:1fr; } }

    .section-title { display:flex; align-items:center; gap:8px; font-weight:800; color:var(--pri); margin:2px 0 8px; }
    .row { display:flex; gap:10px; align-items:center; }
    .row > * { flex:1; }
    label { font-weight:700; font-size:14px; color:#233; }
    select, input[type="number"], input[type="text"] { width:100%; border:1px solid rgba(0,0,0,.12); border-radius:10px; padding:10px 12px; background:#fff; }
    .hint { color:var(--muted); font-size:12px; margin-top:4px; }

    .q { border:1px dashed rgba(10,61,98,.18); border-radius:14px; padding:12px; background:#fff; }
    .q-title { font-weight:700; margin:2px 0 8px; }
    .likert { display:flex; gap:6px; }
    .likert input { display:none; }
    .likert label { flex:1; text-align:center; border:1px solid rgba(0,0,0,.12); border-radius:10px; padding:8px 6px; cursor:pointer; background:#fafafa; transition:all .2s; font-weight:700; }
    .likert input:checked + label { background:linear-gradient(135deg,#e6f4ff,#e9f7ff); border-color:#7fb2ff; color:#0a3d62; box-shadow:0 0 0 3px rgba(127,178,255,.15) inset; }

    .progress { height:10px; background:#e9eef4; border-radius:999px; overflow:hidden; }
    .progress > span { display:block; height:100%; width:0%; background:linear-gradient(90deg,#4f46e5,#0ea5e9); transition:width .3s ease; }

    .actions { display:flex; gap:10px; justify-content:flex-end; margin-top:8px; }
    .btn { border:0; padding:10px 16px; border-radius:12px; font-weight:800; cursor:pointer; transition:transform .06s ease; }
    .btn:active{ transform: translateY(1px); }
    .btn-primary { background:linear-gradient(135deg,#0a3d62,#1d4c78); color:#fff; }
    .btn-secondary { background:#fff; border:1px solid rgba(0,0,0,.12); }

    .results { display:none; }
    .result-item { border:1px solid rgba(0,0,0,.08); border-radius:14px; background:#fff; padding:12px; }
    .tag { display:inline-block; font-size:12px; padding:2px 8px; border-radius:999px; border:1px solid rgba(0,0,0,.1); }
    .tag.ok{ color:#065f46; background:#ecfdf5; border-color:#a7f3d0; }
    .tag.warn{ color:#7c2d12; background:#fffbeb; border-color:#fde68a; }
    .tag.bad{  color:#7f1d1d; background:#fef2f2; border-color:#fecaca; }

    .divider { height:1px; background:rgba(0,0,0,.06); margin:14px 0; }
    .footnote { font-size:12px; color:var(--muted); }

    .pill { display:inline-flex; align-items:center; gap:6px; padding:4px 10px; border-radius:999px; background:#f1f5f9; border:1px solid rgba(0,0,0,.06); font-size:12px; }
  </style>
<style>
@media (max-width: 600px){
  .container { padding: 0 12px; }
  .page-header h1 { font-size: 22px; }
  .page-header .sub { font-size: 12px; line-height: 1.6; }
  .card { padding: 18px 14px; }
  .row { flex-direction: column; gap: 6px; }
  select, input[type="number"], input[type="text"] { font-size: 16px; padding: 12px; width: 100%; }
  label { font-size: 14px; margin-bottom: 4px; display:block; }
  .q-title { font-size: 15px; line-height: 1.6; }
  .likert label { padding: 10px 0; font-size: 15px; }
  .actions { flex-direction: column; gap: 8px; }
  .btn { width: 100%; }
}
</style>
<meta content="ุฎุฏูุงุช ุงูุฅุฑุดุงุฏ ุงูุฃูุงุฏููู ูู ุฌุงูุนุฉ ุงููุนุฑูุฉ ููุณุงุนุฏุฉ ุงูุทูุงุจ ุนูู ุงูุชุฎุทูุท ููุณุงุฑูู ุงูุฏุฑุงุณู ุจูุฌุงุญ." name="description"/><meta content="ุฌุงูุนุฉ ุงููุนุฑูุฉ | ุงูุฅุฑุดุงุฏ ุงูุฃูุงุฏููู" property="og:title"/><meta content="ุฎุฏูุงุช ุงูุฅุฑุดุงุฏ ุงูุฃูุงุฏููู ูู ุฌุงูุนุฉ ุงููุนุฑูุฉ ููุณุงุนุฏุฉ ุงูุทูุงุจ ุนูู ุงูุชุฎุทูุท ููุณุงุฑูู ุงูุฏุฑุงุณู ุจูุฌุงุญ." property="og:description"/><meta content="/assets/images/arts-logo.webp" property="og:image"/><link href="https://fonts.googleapis.com" rel="preconnect"/><link crossorigin="True" href="https://fonts.gstatic.com" rel="preconnect"/><meta content="ar_AR" property="og:locale"/><meta content="summary_large_image" name="twitter:card"/><meta content="ุฌุงูุนุฉ ุงููุนุฑูุฉ | ุงูุฅุฑุดุงุฏ ุงูุฃูุงุฏููู" name="twitter:title"/><meta content="ุฎุฏูุงุช ุงูุฅุฑุดุงุฏ ุงูุฃูุงุฏููู ูู ุฌุงูุนุฉ ุงููุนุฑูุฉ ููุณุงุนุฏุฉ ุงูุทูุงุจ ุนูู ุงูุชุฎุทูุท ููุณุงุฑูู ุงูุฏุฑุงุณู ุจูุฌุงุญ." name="twitter:description"/><meta content="/assets/images/arts-logo.webp" name="twitter:image"/><link href="https://example.com/advisor.html" rel="canonical"/><link href="favicon.png" rel="icon" type="image/png"/><link href="favicon.ico" rel="shortcut icon" type="image/x-icon"/></head>
<body>
<div id="status-bar-placeholder"></div>
<div class="container">
<div class="page-header">
<div>
<h1>ุงููุณุชุดุงุฑ ุงูุฐูู ููุชุฎุตุตุงุช</h1>
<div class="sub">ุงุณุชุดุงุฑุฉ ุงุญุชุฑุงููุฉ ูุทูุจุฉ ุงูุซุงูููุฉ ูุชุญุฏูุฏ ุงููููู ููุณุงุฑุงุช ุงูุฏุฑุงุณุฉ ุงูุฃูุณุจุ ูุน ูุฑุงุนุงุฉ ุงููุณุงุฑ ูุงููุนุฏู ูุงูุญุฏูุฏ ุงูุฏููุง.</div>
</div>
<span class="chip">๐งญุชูุตูุงุช ุดุฎุตูุฉ</span>
</div>
<!-- ุจูุงูุงุช ุงูุทุงูุจ ุงูุฃุณุงุณูุฉ -->
<div class="card grid cols-2" id="student-section">
<div>
<div class="section-title">๐ค ุจูุงูุงุชู</div>
<div class="row">
<div>
<label for="studentName">ุงูุงุณู</label>
<input id="studentName" placeholder="ุณููููุฃ ุชููุงุฆููุง ุฅู ุฃููู" type="text"/>
<div class="hint">ุฅู ูุงู ุงุณูู ูุญููุธูุง ูู ุงููุนุจุฉ ุณูุธูุฑ ุชููุงุฆููุง.</div>
</div>
<div>
<label for="tawjihiStream">ุงููุณุงุฑ</label>
<select id="tawjihiStream">
<option value="ุนููู">ุนููู</option>
<option value="ุฃุฏุจู">ุฃุฏุจู</option>
<option value="ุตูุงุนู">ุตูุงุนู</option>
<option value="ุดุฑุนู">ุดุฑุนู</option>
</select>
</div>
</div>
<div class="row">
<div>
<label for="avg">ูุนุฏูู ุงูุซุงูููุฉ (ูช)</label>
<input id="avg" max="100" min="40" placeholder="ูุซุงู: 82.7" step="0.1" type="number"/>
<div class="hint">ูุณุชุฎุฏู ูููุงุณ ุฃูููุฉ ุงููุจูู ููุท โ ูุง ูุคุซุฑ ุนูู ุชุฑุชูุจ ุงููููู ูุจุงุดุฑุฉ.</div>
</div>
<div>
<label for="workEnv">ุฃูุถู ุจูุฆุฉ ุนูู ูุณุชูุจููุฉ</label>
<select id="workEnv">
<option value="ูุฎุชุจุฑุงุช">ูุฎุชุจุฑุงุช ูุจุญูุซ</option>
<option value="ูุณุชุดูู">ูุณุชุดูู/ุฑุนุงูุฉ ุตุญูุฉ</option>
<option value="ุดุฑูุฉ-ุชูููุฉ">ุดุฑูุฉ ุชูููุฉ/ุจุฑูุฌุฉ</option>
<option value="ููุฏุงู">ููุฏุงู/ูุดุงุฑูุน/ููุงูุน</option>
<option value="ููุชุจ">ููุชุจ ูุฅุฏุงุฑุฉ</option>
<option value="ุชุนููู">ูุฏุฑุณุฉ/ุชุนููู</option>
<option value="ุฅุนูุงู">ุฅุนูุงู/ุตุญุงูุฉ/ูุชุงุจุฉ</option>
<option value="ูุงููู">ูุงููู/ูุญุงูุงุฉ/ุชุดุฑูุน</option>
</select>
</div>
</div>
</div>
<div>
<div class="section-title">๐ ููุงุฏ ุชููู ุฅูููุง (ุงุฎุชูุงุฑู)</div>
<div class="row">
<div>
<label for="fav">ุงุฎุชุฑ ุฃูุซุฑ ูู ูุงุฏุฉ</label>
<select id="fav" multiple="" style="height:106px;">
<option>ุฑูุงุถูุงุช</option><option>ููุฒูุงุก</option><option>ููููุงุก</option><option>ุฃุญูุงุก</option>
<option>ุญุงุณูุจ</option><option>ูุบุฉ ุนุฑุจูุฉ</option><option>ูุบุฉ ุฅูุฌููุฒูุฉ</option>
<option>ุชุงุฑูุฎ</option><option>ุฌุบุฑุงููุง</option><option>ุงูุชุตุงุฏ</option><option>ุชุฑุจูุฉ ูููุฉ</option>
</select>
</div>
<div>
<label for="notes">ูููุฏ/ููุงุญุธุงุช (ุงุฎุชูุงุฑู)</label>
<input id="notes" placeholder="ูุซุงู: ูุง ุฃูุถูู ุงูููุงูุจุงุช ุงูููููุฉุ ุฃูุถูู ุนูู ูุฑูุจ ูู ุงูููุฒู..." type="text"/>
<div class="hint">ุชูุณุชุฎุฏู ูุชุนุฏูู ุงูุชูุตูุงุช (ุชุนููู/ููุงูุจุงุช/ููุฏุงู...).</div>
</div>
</div>
</div>
</div>
<!-- ุฃุณุฆูุฉ ุงููููู (ููุณูุนุฉ) -->
<div class="card" style="margin-top:14px;">
<div class="section-title">๐งช ูููุงุณ ุงููููู (ุงุฎุชุฑ ูู 1 ุฅูู 5)</div>
<div id="questions"></div>
<div class="progress" style="margin:10px 0 4px;">
<span id="progressBar"></span>
</div>
<div class="actions">
<button class="btn btn-secondary" id="btnPrev">ุงูุณุงุจู</button>
<button class="btn btn-primary" id="btnNext">ุงูุชุงูู</button>
</div>
<div class="hint">ูู ูุณุชุบุฑู ุงูุฃูุฑ ุฃูุซุฑ ูู 3โ5 ุฏูุงุฆู. <span class="pill"><span id="answeredCount">0</span>/<span id="totalCount">0</span> ูุฌุงุจ</span></div>
</div>
<!-- ุงููุชุงุฆุฌ -->
<div class="card results" id="results">
<div class="section-title">๐ ุชุฑุดูุญุงุชู ุงูุดุฎุตูุฉ</div>
<div class="grid cols-2" id="topPicks"></div>
<div class="divider"></div>
<div class="section-title">๐ ููุงุฐุง ูุฐู ุงูุชุฑุดูุญุงุชุ</div>
<div class="grid" id="factors"></div>
<div class="divider"></div>
<div class="section-title">๐ ุฌููุน ุงููุชุงุฆุฌ ุญุณุจ ุงูููุงุกูุฉ</div>
<div id="details"></div>
<div class="divider"></div>
<div style="display:flex; gap:8px; justify-content:flex-end;">
<button class="btn btn-secondary" onclick="window.location.href='index.html'">ุงูุนูุฏุฉ ุฅูู ุงูุฎุฑูุทุฉ</button>
<button class="btn btn-primary" id="btnSave">ุญูุธ ูุฅุฑุณุงู (ุงุฎุชูุงุฑู)</button>
</div>
<div class="footnote" style="margin-top:8px;">ุชูุจูู: ูุฐู ุงูุชูุตูุงุช ุฅุฑุดุงุฏูุฉ ูููุณุช ูุฑุงุฑ ูุจูู ููุงุฆู. ุงููุจูู ูุฑุชุจุท ุจุงูุฃูุธูุฉ ูุงูููุงุฆุญ ูุงูุญุฏูุฏ ุงูุฏููุง ููู ูููุฉ/ุจุฑูุงูุฌ.</div>
</div>
</div>
<script>
/* =======================
   1) ุฑุจุท ุงูุงุณู ุชููุงุฆููุง ุจุงููููุน
   ======================= */
function autoFillNameFromSite(){
  try {
    // ูู ุงูุฐุงูุฑุฉ ุงูุนุงูุฉ ุฅู ููุฌุฏุช
    if (window.gameState && window.gameState.playerName) {
      document.getElementById('studentName').value = window.gameState.playerName;
      return;
    }
    // ูู ุงูุชุฎุฒูู ุงูุนุงู ูููููุน
    const gp = JSON.parse(localStorage.getItem('iugGameProgress')||'null');
    if (gp && gp.playerName) {
      document.getElementById('studentName').value = gp.playerName;
    }
  } catch(e){}
}

/* =======================
   2) ุชูููู ุงูุชุฎุตุตุงุช ูุงูุญุฏูุฏ ุงูุฏููุง
   (ูุงุจูุฉ ููุชุญุฏูุซ ุณููููุง ูู ุฅุฏุงุฑุฉ ุงููุจูู)
   ======================= */
const MAJORS = {
  medicine:   { name:"ุงูุทุจ ุงูุจุดุฑู", faculty:"ุงูุทุจ", streams:{"ุนููู":95,"ุฃุฏุจู":null,"ุตูุงุนู":null,"ุดุฑุนู":null}, axes:{life:1.0, empathy:0.9, lab:0.6, shift:0.6} },
  civil:      { name:"ุงูููุฏุณุฉ ุงููุฏููุฉ", faculty:"ุงูููุฏุณุฉ", streams:{"ุนููู":80,"ุฃุฏุจู":null,"ุตูุงุนู":80,"ุดุฑุนู":null}, axes:{stem:1.0, field:0.9, spatial:0.5, problem:0.7} },
  arch:       { name:"ุงูููุฏุณุฉ ุงููุนูุงุฑูุฉ", faculty:"ุงูููุฏุณุฉ", streams:{"ุนููู":80,"ุฃุฏุจู":null,"ุตูุงุนู":80,"ุดุฑุนู":null}, axes:{spatial:1.0, design:0.9, stem:0.6} },
  comp_eng:   { name:"ููุฏุณุฉ ุงูุญุงุณูุจ", faculty:"ุงูููุฏุณุฉ", streams:{"ุนููู":80,"ุฃุฏุจู":null,"ุตูุงุนู":80,"ุดุฑุนู":null}, axes:{stem:0.9, coding:1.0, electronics:0.8, problem:0.8} },
  mech:       { name:"ุงูููุฏุณุฉ ุงููููุงููููุฉ", faculty:"ุงูููุฏุณุฉ", streams:{"ุนููู":80,"ุฃุฏุจู":null,"ุตูุงุนู":80,"ุดุฑุนู":null}, axes:{stem:0.9, field:0.7, tinkering:0.8, physics:0.6} },
  industrial: { name:"ุงูููุฏุณุฉ ุงูุตูุงุนูุฉ", faculty:"ุงูููุฏุณุฉ", streams:{"ุนููู":80,"ุฃุฏุจู":null,"ุตูุงุนู":80,"ุดุฑุนู":null}, axes:{stem:0.8, business:0.6, problem:0.8, optimization:0.8} },
  electrical: { name:"ุงูููุฏุณุฉ ุงูููุฑุจุงุฆูุฉ", faculty:"ุงูููุฏุณุฉ", streams:{"ุนููู":80,"ุฃุฏุจู":null,"ุตูุงุนู":80,"ุดุฑุนู":null}, axes:{stem:0.9, electronics:0.9, physics:0.7} },
  env_eng:    { name:"ุงูููุฏุณุฉ ุงูุจูุฆูุฉ", faculty:"ุงูููุฏุณุฉ", streams:{"ุนููู":80,"ุฃุฏุจู":null,"ุตูุงุนู":80,"ุดุฑุนู":null}, axes:{stem:0.7, environment:1.0, field:0.7, chemistry:0.5} },

  cs:         { name:"ุนููู ุงูุญุงุณูุจ", faculty:"ุชูููููุฌูุง ุงููุนูููุงุช", streams:{"ุนููู":65,"ุฃุฏุจู":65,"ุตูุงุนู":65,"ุดุฑุนู":65}, axes:{coding:1.0, problem:0.9, math:0.7} },
  it:         { name:"ุชูููููุฌูุง ุงููุนูููุงุช", faculty:"ุชูููููุฌูุง ุงููุนูููุงุช", streams:{"ุนููู":65,"ุฃุฏุจู":65,"ุตูุงุนู":65,"ุดุฑุนู":65}, axes:{coding:0.8, systems:0.8, comm:0.6} },
  web:        { name:"ุชูููุงุช ุงููุณุงุฆุท ุงููุชุนุฏุฏุฉ ูุชุทููุฑ ุงูููุจ", faculty:"ุชูููููุฌูุง ุงููุนูููุงุช", streams:{"ุนููู":65,"ุฃุฏุจู":70,"ุตูุงุนู":65,"ุดุฑุนู":65}, axes:{coding:0.7, design:0.8, media:0.8} },
  cybersecurity:{ name:"ุงูุฃูู ุงูุณูุจุฑุงูู", faculty:"ุชูููููุฌูุง ุงููุนูููุงุช", streams:{"ุนููู":70,"ุฃุฏุจู":70,"ุตูุงุนู":70,"ุดุฑุนู":70}, axes:{coding:0.8, problem:0.9, systems:0.8} },

  math:       { name:"ุงูุฑูุงุถูุงุช", faculty:"ุงูุนููู", streams:{"ุนููู":65,"ุฃุฏุจู":null,"ุตูุงุนู":65,"ุดุฑุนู":null}, axes:{math:1.0, stem:0.9, research:0.7} },
  physicsM:   { name:"ุงูููุฒูุงุก", faculty:"ุงูุนููู", streams:{"ุนููู":65,"ุฃุฏุจู":null,"ุตูุงุนู":65,"ุดุฑุนู":null}, axes:{physics:1.0, stem:0.9, research:0.7} },
  chemistryM: { name:"ุงูููููุงุก", faculty:"ุงูุนููู", streams:{"ุนููู":65,"ุฃุฏุจู":null,"ุตูุงุนู":65,"ุดุฑุนู":null}, axes:{chemistry:1.0, lab:0.9, research:0.7} },
  biologyM:   { name:"ุงูุฃุญูุงุก", faculty:"ุงูุนููู", streams:{"ุนููู":65,"ุฃุฏุจู":null,"ุตูุงุนู":65,"ุดุฑุนู":null}, axes:{life:1.0, lab:0.7, research:0.6} },
  earth:      { name:"ุนููู ุงูุฃุฑุถ ูุงูุจูุฆุฉ", faculty:"ุงูุนููู", streams:{"ุนููู":65,"ุฃุฏุจู":null,"ุตูุงุนู":65,"ุดุฑุนู":null}, axes:{environment:1.0, field:0.7} },

  med_imaging:{ name:"ุชูููุงุช ุงูุชุตููุฑ ุงูุทุจู", faculty:"ุงูุนููู ุงูุตุญูุฉ", streams:{"ุนููู":70,"ุฃุฏุจู":70,"ุตูุงุนู":70,"ุดุฑุนู":70}, axes:{life:0.8, lab:0.7, tech:0.6} },
  nutrition:  { name:"ุงูุชุบุฐูุฉ ุงูุณุฑูุฑูุฉ", faculty:"ุงูุนููู ุงูุตุญูุฉ", streams:{"ุนููู":70,"ุฃุฏุจู":80,"ุตูุงุนู":70,"ุดุฑุนู":70}, axes:{life:0.8, empathy:0.7, research:0.5} },
  physio:     { name:"ุงูุนูุงุฌ ุงูุทุจูุนู", faculty:"ุงูุนููู ุงูุตุญูุฉ", streams:{"ุนููู":70,"ุฃุฏุจู":70,"ุตูุงุนู":70,"ุดุฑุนู":70}, axes:{life:0.7, empathy:0.7, field:0.6} },

  nursing:    { name:"ุงูุชูุฑูุถ", faculty:"ุงูุชูุฑูุถ", streams:{"ุนููู":70,"ุฃุฏุจู":70,"ุตูุงุนู":70,"ุดุฑุนู":70}, axes:{empathy:1.0, life:0.9, shift:0.7} },
  midwifery:  { name:"ุงููุจุงูุฉ", faculty:"ุงูุชูุฑูุถ/ุงููุจุงูุฉ", streams:{"ุนููู":80,"ุฃุฏุจู":80,"ุตูุงุนู":80,"ุดุฑุนู":80}, axes:{empathy:0.9, life:0.9, shift:0.6} },

  accounting: { name:"ุงููุญุงุณุจุฉ", faculty:"ุงูุงูุชุตุงุฏ ูุงูุนููู ุงูุฅุฏุงุฑูุฉ", streams:{"ุนููู":65,"ุฃุฏุจู":65,"ุตูุงุนู":65,"ุดุฑุนู":65}, axes:{business:0.9, office:0.8, math:0.6} },
  business:   { name:"ุฅุฏุงุฑุฉ ุงูุฃุนูุงู", faculty:"ุงูุงูุชุตุงุฏ ูุงูุนููู ุงูุฅุฏุงุฑูุฉ", streams:{"ุนููู":65,"ุฃุฏุจู":65,"ุตูุงุนู":65,"ุดุฑุนู":65}, axes:{business:1.0, comm:0.7, entrepreneurship:0.7} },
  marketing:  { name:"ุงูุชุณููู ูุงูุงุจุชูุงุฑ (ุฅููุชุฑููู/ุฑููู)", faculty:"ุงูุงูุชุตุงุฏ ูุงูุนููู ุงูุฅุฏุงุฑูุฉ", streams:{"ุนููู":65,"ุฃุฏุจู":65,"ุตูุงุนู":65,"ุดุฑุนู":65}, axes:{media:0.7, business:0.8, comm:0.8} },
  finance:    { name:"ุงูุชูููู ูุงููุตุงุฑู", faculty:"ุงูุงูุชุตุงุฏ ูุงูุนููู ุงูุฅุฏุงุฑูุฉ", streams:{"ุนููู":65,"ุฃุฏุจู":65,"ุตูุงุนู":65,"ุดุฑุนู":65}, axes:{business:0.9, math:0.6, office:0.8} },

  law:        { name:"ุงููุงููู", faculty:"ุงูุดุฑูุนุฉ ูุงููุงููู", streams:{"ุนููู":65,"ุฃุฏุจู":75,"ุตูุงุนู":65,"ุดุฑุนู":65}, axes:{law:1.0, comm:0.8, ethics:0.8} },
  sharia:     { name:"ุงูุดุฑูุนุฉ", faculty:"ุงูุดุฑูุนุฉ ูุงููุงููู", streams:{"ุนููู":65,"ุฃุฏุจู":65,"ุตูุงุนู":65,"ุดุฑุนู":65}, axes:{religion:1.0, comm:0.6, ethics:0.8} },
  usul:       { name:"ุฃุตูู ุงูุฏูู", faculty:"ุฃุตูู ุงูุฏูู", streams:{"ุนููู":65,"ุฃุฏุจู":65,"ุตูุงุนู":65,"ุดุฑุนู":65}, axes:{religion:1.0, comm:0.5} },

  arabic:     { name:"ุงููุบุฉ ุงูุนุฑุจูุฉ", faculty:"ุงูุขุฏุงุจ", streams:{"ุนููู":65,"ุฃุฏุจู":65,"ุตูุงุนู":65,"ุดุฑุนู":65}, axes:{language:1.0, media:0.4} },
  english:    { name:"ุงููุบุฉ ุงูุฅูุฌููุฒูุฉ", faculty:"ุงูุขุฏุงุจ", streams:{"ุนููู":65,"ุฃุฏุจู":65,"ุตูุงุนู":65,"ุดุฑุนู":65}, axes:{language:1.0, media:0.4} },
  journalism: { name:"ุงูุตุญุงูุฉ ูุงูุฅุนูุงู", faculty:"ุงูุขุฏุงุจ", streams:{"ุนููู":65,"ุฃุฏุจู":65,"ุตูุงุนู":65,"ุดุฑุนู":65}, axes:{media:1.0, language:0.7, comm:0.9} },
  geography:  { name:"ุงูุฌุบุฑุงููุง", faculty:"ุงูุขุฏุงุจ", streams:{"ุนููู":65,"ุฃุฏุจู":65,"ุตูุงุนู":65,"ุดุฑุนู":65}, axes:{environment:0.6, field:0.6, media:0.4} },

  teacher:    { name:"ูุนูู ุตู/ุฃุณุงุณ", faculty:"ุงูุชุฑุจูุฉ", streams:{"ุนููู":65,"ุฃุฏุจู":65,"ุตูุงุนู":65,"ุดุฑุนู":65}, axes:{education:1.0, patience:0.8, comm:0.8} },
  english_teach:{ name:"ุชุนููู ุฅูุฌููุฒู", faculty:"ุงูุชุฑุจูุฉ", streams:{"ุนููู":65,"ุฃุฏุจู":65,"ุตูุงุนู":65,"ุดุฑุนู":65}, axes:{education:0.9, language:1.0, comm:0.8} },
  social_teach:{ name:"ุชุนููู ุงุฌุชูุงุนูุงุช/ุชุงุฑูุฎ", faculty:"ุงูุชุฑุจูุฉ", streams:{"ุนููู":65,"ุฃุฏุจู":65,"ุตูุงุนู":65,"ุดุฑุนู":65}, axes:{education:0.9, media:0.5, comm:0.8} },
};

// ูุญุงูุฑ/ุฃุจุนุงุฏ ุงููููู (Likert 1..5) โ ููุณูุน (40 ุณุคุงููุง)
const QUESTIONS = [
  // STEM & Math/Physics/Chemistry
  { id:"q1", axis:"stem", text:"ุฃุณุชูุชุน ุจุญู ูุณุงุฆู ุงูุฑูุงุถูุงุช ูุงูููุทู." },
  { id:"q2", axis:"math", text:"ุงููุนุงุฏูุงุช ูุงูุชุญููู ุงูุฑูุงุถู ููุชุนุงู ุจุงููุณุจุฉ ูู." },
  { id:"q3", axis:"physics", text:"ุฃููู ูููู ุงูุธูุงูุฑ ุงูููุฒูุงุฆูุฉ ูุงููููุงููููุฉ." },
  { id:"q4", axis:"chemistry", text:"ุฃุณุชูุชุน ุจุงูููููุงุก ูุงูุชูุงุนูุงุช ูุชูุณูุฑูุง." },

  // Coding / Systems / Cyber
  { id:"q5", axis:"coding", text:"ุฃุญุจ ุงูุจุฑูุฌุฉ ุฃู ุจูุงุก ุชุทุจููุงุช ุจุงุณุชุฎุฏุงู ุงูุญุงุณูุจ." },
  { id:"q6", axis:"systems", text:"ุฃููู ุงูุดุจูุงุช/ุงูุฃูุธูุฉ ุฃู ุฃุญุจ ุชุนููููุง." },
  { id:"q7", axis:"problem", text:"ุฃุณุชูุชุน ุจุชูููู ุงููุดููุงุช ุงููุจูุฑุฉ ุฅูู ุฎุทูุงุช ุตุบูุฑุฉ." },
  { id:"q8", axis:"electronics", text:"ุฃููู ููุฅููุชุฑูููุงุช ูุงูุฏูุงุฆุฑ." },

  // Life/Health/Bio
  { id:"q9", axis:"life", text:"ุฃููู ููููุงุฏ ุงูุญูุงุชูุฉ (ุฃุญูุงุก/ููููุงุก ุญูููุฉ) ุฃูุซุฑ ูู ุงูููุฒูุงุก." },
  { id:"q10", axis:"lab", text:"ุฃุณุชูุชุน ุจุงูุนูู ูู ุงููุฎุชุจุฑ ูุฅุฌุฑุงุก ุงูุชุฌุงุฑุจ." },
  { id:"q11", axis:"empathy", text:"ุฃุณุชุทูุน ุงูุชุนุงูู ุจุชุนุงุทู ูุตุจุฑ ูุน ุงููุฑุถู/ุงููุงุณ ูุณุงุนุงุช." },
  { id:"q12", axis:"shift", text:"ูุง ุฃูุงูุน ูุธุงู ุงูููุงูุจุงุช ูู ุงูููู/ุงูุนุทู ุนูุฏ ุงูุญุงุฌุฉ." },

  // Field/Design/Spatial
  { id:"q13", axis:"field", text:"ุฃูุถู ุงูุฃุนูุงู ุงูููุฏุงููุฉ ูุงูุชูููุฐ ูู ููุงูุน ุงููุดุงุฑูุน." },
  { id:"q14", axis:"spatial", text:"ูุฏูู ุญุณู ููุงูู/ุชุตูููู ุฌูุฏ (ุชูููุฑ ููุฏุณู/ูุนูุงุฑู)." },
  { id:"q15", axis:"design", text:"ุฃุญุจ ุงูุชุตููู ุงูุจุตุฑู/ุงููุนูุงุฑู ุฃู ุชุฌุฑุจุฉ ูุณุชุฎุฏู." },
  { id:"q16", axis:"tinkering", text:"ุฃุณุชูุชุน ุจูู ูุชุฑููุจ ุงูุฃุดูุงุก (ููุญุจ ููุชุฌุฑูุจ ุงูุนููู)." },

  // Business/Office/Entrepreneurship
  { id:"q17", axis:"business", text:"ุฃููู ููุฃุนูุงู/ุงูุชุฌุงุฑุฉ/ุงููุญุงุณุจุฉ ูุชุฎุทูุท ุงููุดุงุฑูุน." },
  { id:"q18", axis:"office", text:"ุฃูุถู ุจูุฆุฉ ุงูุนูู ุงูููุชุจูุฉ ุงููุงุฏุฆุฉ ุนูู ุงูููุฏุงู." },
  { id:"q19", axis:"entrepreneurship", text:"ุฃูููุฑ ุจุฑูุงุฏุฉ ุงูุฃุนูุงู ูุงุจุชูุงุฑ ูุดุงุฑูุน." },
  { id:"q20", axis:"optimization", text:"ุฃุญุจ ุชุญุณูู ุงูุฅุฌุฑุงุกุงุช ูุชูููู ุงููุฏุฑ/ุงูููุช." },

  // Media/Language/Law/Religion
  { id:"q21", axis:"language", text:"ุฃุณุชูุชุน ุจุงููุฑุงุกุฉ/ุงููุชุงุจุฉ/ุงููุบุงุช (ุนุฑุจูุฉ/ุฅูุฌููุฒูุฉ)." },
  { id:"q22", axis:"media", text:"ุฃููู ููุฅุนูุงู ูุงูุตุญุงูุฉ ูุตูุงุนุฉ ุงููุญุชูู." },
  { id:"q23", axis:"law", text:"ุฃูุชู ุจุงููุงููู/ุงูุญููู/ุงูุนุฏู ูุงูููุงุดุงุช ุงููุงููููุฉ." },
  { id:"q24", axis:"religion", text:"ุฃููู ููุฏุฑุงุณุงุช ุงูุดุฑุนูุฉ ูุงูุนููู ุงูุฅุณูุงููุฉ." },

  // Education/Comm/Patience
  { id:"q25", axis:"education", text:"ุฃุญุจ ุงูุชุนููู ูุดุฑุญ ุงูุฃููุงุฑ ููุขุฎุฑูู." },
  { id:"q26", axis:"comm", text:"ุฃูุชูู ููุงุฑุงุช ุชูุงุตู ููุชุงุฒุฉ ูุฃุญุจ ุงูุชุนุงูู ูุน ุงููุงุณ." },
  { id:"q27", axis:"patience", text:"ุตุจูุฑู ูู ุงูุชุนุงูู ูุน ุงูุฃุทูุงู/ุงููุชุนูููู ูุฃููุงุช ุทูููุฉ." },

  // Research/Environment
  { id:"q28", axis:"research", text:"ุฃุณุชูุชุน ุจุงูุจุญุซ ุงูุนููู ูุงููุฑุงุกุฉ ุงููุชุนููุฉ." },
  { id:"q29", axis:"environment", text:"ุฃูุชู ุจุงูุจูุฆุฉ/ุงูุงุณุชุฏุงูุฉ/ุงูููุงุฎ." },
  { id:"q30", axis:"tech", text:"ุฃููู ููุชูููุงุช ุงูุทุจูุฉ/ุงูุฃุฌูุฒุฉ." },

  // Extra depth (10 ุฃูุซุฑ ููุงูุนูุฉ ูุจูุฑุฉ)
  { id:"q31", axis:"ai", text:"ุฃุญุจ ุงูุฐูุงุก ุงูุงุตุทูุงุนู ูุชุญููู ุงูุจูุงูุงุช." },
  { id:"q32", axis:"network", text:"ุงูุดุจูุงุช/ุงูุฃูู ูุงูุชุดููุฑ ูุฌุงูุงุช ุชููููู." },
  { id:"q33", axis:"anatomy", text:"ุฃุณุชูุชุน ุจุฏุฑุงุณุฉ ุฌุณู ุงูุฅูุณุงู ููุธุงุฆูู." },
  { id:"q34", axis:"pharma", text:"ุฃูุชู ุจุงูุฃุฏููุฉ ูุชุฑููุจูุง ูุขุซุงุฑูุง." },
  { id:"q35", axis:"geospatial", text:"ุฃููู ูุฎุฑุงุฆุท GIS ูุงูุงุณุชูุดุงู ุงูุฌุบุฑุงูู." },
  { id:"q36", axis:"publicSpeaking", text:"ุฃุญุจ ุงูุชูุฏูู ูุงูุฎุทุงุจุฉ ูุงูุญูุงุฑ." },
  { id:"q37", axis:"history", text:"ุฃุณุชูุชุน ุจุงูุชุงุฑูุฎ ูุงูุนููู ุงูุฅูุณุงููุฉ." },
  { id:"q38", axis:"arts", text:"ุฃููู ูููููู ุงูุจุตุฑูุฉ/ุงูุชุตููู ุงูุฌุฑุงูููู." },
  { id:"q39", axis:"caregiving", text:"ุฃุฌุฏ ููุณู ูู ุฑุนุงูุฉ ุงูุขุฎุฑูู ูุชูุฏูู ุงูุฏุนู ุงูููุณู." },
  { id:"q40", axis:"discipline", text:"ููุถุจุท ูู ุงูุฏุฑุงุณุฉ ูุงูุงูุชุฒุงู ุจูุชุทูุจุงุช ุทูููุฉ ุงููุฏู." },
];

const qWrap = document.getElementById('questions');
const progressEl = document.getElementById('progressBar');
const btnPrev = document.getElementById('btnPrev');
const btnNext = document.getElementById('btnNext');
const ansCount = document.getElementById('answeredCount');
const totalCount = document.getElementById('totalCount');

let currentIndex = 0;
const answers = {}; // { qid: 1..5 }
totalCount.textContent = QUESTIONS.length;

// ุจูุงุก ุงูุณุคุงู ุงูุญุงูู
function renderQuestion(i){
  const q = QUESTIONS[i];
  const val = answers[q.id] || 3;
  qWrap.innerHTML = `
    <div class="q">
      <div class="q-title">${i+1}. ${q.text}</div>
      <div class="likert">
        ${[1,2,3,4,5].map(v=>`<input type="radio" id="${q.id}-${v}" name="${q.id}" value="${v}" ${val===v? 'checked':''} />
                                <label for="${q.id}-${v}">${v}</label>`).join('')}
      </div>
    </div>`;
  [...qWrap.querySelectorAll('input[type=radio]')].forEach(inp=>{
    inp.addEventListener('change', e => {
      answers[q.id] = Number(e.target.value);
      updateCounters();
      saveLocal();
    });
  });
  progressEl.style.width = ((i+1)/QUESTIONS.length*100).toFixed(1)+"%";
  btnPrev.disabled = (i===0);
  btnNext.textContent = (i===QUESTIONS.length-1)? 'ุนุฑุถ ุงููุชุงุฆุฌ' : 'ุงูุชุงูู';
}

function updateCounters(){
  let count = 0;
  for (const q of QUESTIONS){ if (answers[q.id]) count++; }
  ansCount.textContent = count;
}

btnPrev.addEventListener('click', ()=>{ if(currentIndex>0){ currentIndex--; renderQuestion(currentIndex); } });
btnNext.addEventListener('click', ()=>{
  if (currentIndex < QUESTIONS.length-1){ currentIndex++; renderQuestion(currentIndex); }
  else { computeResults(); }
});

// ุญุณุงุจ ุงููุชุงุฆุฌ
function getSelectedMultiple(selectEl){ return [...selectEl.selectedOptions].map(o=>o.value); }

function computeResults(){
  const stream = document.getElementById('tawjihiStream').value;
  const avg = Number(document.getElementById('avg').value || 0);
  const fav = new Set(getSelectedMultiple(document.getElementById('fav')));
  const workEnv = document.getElementById('workEnv').value;
  const name = document.getElementById('studentName').value.trim();

  // ุชุฌููุน ูุญุงูุฑ ุงููููู ุฅูู 0..1
  const axisScores = {}; // axis -> 0..1
  QUESTIONS.forEach(q => { axisScores[q.axis] = (axisScores[q.axis]||0) + (answers[q.id]||3); });
  Object.keys(axisScores).forEach(k => { axisScores[k] = axisScores[k] / (5 * QUESTIONS.filter(x=>x.axis===k).length || 1); });

  // ุชุนุฒูุฒุงุช ููู ุงูููุงุฏ ุงูููุถูุฉ ูุงูุจูุฆุฉ
  function boost(axis, amount){ axisScores[axis] = Math.min(1, (axisScores[axis]||0) + amount); }
  if (fav.has('ุฑูุงุถูุงุช')) boost('math', .12);
  if (fav.has('ููุฒูุงุก')) { boost('physics', .08); boost('spatial', .06); }
  if (fav.has('ููููุงุก')) { boost('chemistry', .08); boost('lab', .06); }
  if (fav.has('ุฃุญูุงุก')) { boost('life', .12); boost('lab', .06); }
  if (fav.has('ุญุงุณูุจ')) { boost('coding', .16); boost('problem', .08); boost('systems', .06); }
  if (fav.has('ูุบุฉ ุนุฑุจูุฉ') || fav.has('ูุบุฉ ุฅูุฌููุฒูุฉ')) { boost('language', .12); boost('comm', .06); }
  if (fav.has('ุงูุชุตุงุฏ')) { boost('business', .12); }
  if (fav.has('ุฌุบุฑุงููุง')) { boost('geospatial', .10); boost('environment', .06); }
  if (workEnv==='ูุฎุชุจุฑุงุช'){ ['lab','research'].forEach(ax=>boost(ax,.08)); }
  if (workEnv==='ูุณุชุดูู'){ ['life','empathy','shift'].forEach(ax=>boost(ax,.08)); }
  if (workEnv==='ุดุฑูุฉ-ุชูููุฉ'){ ['coding','problem','office'].forEach(ax=>boost(ax,.08)); }
  if (workEnv==='ููุฏุงู'){ ['field','spatial'].forEach(ax=>boost(ax,.08)); }
  if (workEnv==='ููุชุจ'){ ['office','business'].forEach(ax=>boost(ax,.08)); }
  if (workEnv==='ุชุนููู'){ ['education','patience'].forEach(ax=>boost(ax,.08)); }
  if (workEnv==='ุฅุนูุงู'){ ['media','language','comm'].forEach(ax=>boost(ax,.08)); }
  if (workEnv==='ูุงููู'){ ['law','ethics','comm'].forEach(ax=>boost(ax,.08)); }

  // ูููุฏ ุฅุถุงููุฉ ูู ุงูููุงุญุธุงุช (ุจุดูู ุทููู)
  const notes = (document.getElementById('notes').value||'').toLowerCase();
  if (notes.includes('ูุง ุฃูุถูู ุงูููุงูุจุงุช') || notes.includes('ูุง ุงูุถู ุงูููุงูุจุงุช')) { axisScores['shift'] = Math.min(axisScores['shift']||0, .2); }
  if (notes.includes('ูุฑูุจ') && (axisScores['field']||0) > .6) { axisScores['field'] -= .1; }

  // ุญุณุงุจ ููุงุท ููู ุชุฎุตุต
  const recommendations = Object.entries(MAJORS).map(([key, m]) => {
    let interest = 0, weightSum = 0;
    for (const [ax, w] of Object.entries(m.axes)){
      interest += (axisScores[ax]||0) * w;
      weightSum += w;
    }
    interest = (weightSum? (interest/weightSum):0); // 0..1

    const minForStream = m.streams[stream] ?? null;
    const eligible = (minForStream==null) ? false : (avg >= minForStream);
    const gap = (minForStream==null) ? null : Math.max(0, (minForStream - avg));

    const score = interest + (eligible? 0.12 : 0); // ููุงูุฃุฉ ุจุณูุทุฉ ููุฃูููุฉ
    return { key, score, interest, eligible, gap, minForStream, title:m.name, faculty:m.faculty, axes:m.axes };
  }).sort((a,b)=> b.score - a.score);

  renderResults(recommendations, stream, avg, name, axisScores);
  saveLocal();
  document.getElementById('results').style.display = 'block';
  window.scrollTo({ top: document.getElementById('results').offsetTop - 16, behavior: 'smooth' });
}

// ุนุฑุถ ุงููุชุงุฆุฌ
function renderResults(recs, stream, avg, name, axisScores){
  const topPicks = document.getElementById('topPicks');
  const details = document.getElementById('details');
  const factors = document.getElementById('factors');

  topPicks.innerHTML = '';
  details.innerHTML = '';
  factors.innerHTML = '';

  const hello = name ? `ูุฑุญุจูุง ${name}ุ ` : '';

  // ุฃูุถู 3
  recs.slice(0,3).forEach((r, idx) => {
    const tag = r.eligible ? `<span class="tag ok">ูุคูููู (โฅ ${r.minForStream}ูช)</span>` : (r.minForStream==null? `<span class="tag warn">ุบูุฑ ูุชุงุญ ููุณุงุฑู</span>` : `<span class="tag warn">ุจุญุงุฌุฉ +${(r.gap).toFixed(1)}ูช</span>`);
    const el = document.createElement('div');
    el.className = 'result-item';
    el.innerHTML = `
      <div style="display:flex; align-items:center; justify-content:space-between; gap:12px;">
        <div>
          <div style="font-weight:800; font-size:18px;">${idx===0? 'ุงูุฎูุงุฑ ุงูุฃูู' : idx===1? 'ุงูุฎูุงุฑ ุงูุซุงูู' : 'ุงูุฎูุงุฑ ุงูุซุงูุซ'}</div>
          <div style="font-size:16px; color:#111;">${r.title}</div>
          <div class="sub">ุงููููุฉ: ${r.faculty}</div>
        </div>
        ${tag}
      </div>`;
    topPicks.appendChild(el);
  });

  // ููุงุฐุง ุงุฎุชุฑูุงูุ โ ูุนุฑุถ ุฃุนูู 6 ูุญุงูุฑ ุฃุซูุฑุช ูู ุงูุชุฑุดูุญ ุงูุฃูู
  if (recs.length){
    const top = recs[0];
    const axesSorted = Object.entries(axisScores).sort((a,b)=> b[1]-a[1]).slice(0,6);
    factors.innerHTML = `
      <div class="result-item">
        <div style="font-weight:800; margin-bottom:6px;">${hello}ูุฐู ุฃุจุฑุฒ ุฃุณุจุงุจ ุงูุชุฑุดูุญ:</div>
        <ul style="margin:0 18px; line-height:1.9;">
          ${axesSorted.map(([ax,val])=> `<li>${axisToArabic(ax)}: ${(val*100).toFixed(0)}ูช</li>`).join('')}
        </ul>
      </div>`;
  }

  // ุฌููุน ุงููุชุงุฆุฌ
  recs.forEach(r => {
    const tag = r.eligible ? `<span class="tag ok">ูุคูููู</span>` : (r.minForStream==null? `<span class="tag warn">ุบูุฑ ูุชุงุญ ููุณุงุฑู</span>` : `<span class="tag bad">ูุงูุต ${(r.gap).toFixed(1)}ูช</span>`);
    const row = document.createElement('div'); row.className = 'result-item';
    row.innerHTML = `
      <div style="display:flex; align-items:center; justify-content:space-between; gap:12px; flex-wrap:wrap;">
        <div>
          <div style="font-weight:700;">${r.title}</div>
          <div class="sub">ุงููููุฉ: ${r.faculty}</div>
          <div class="sub">ููุงุกูุฉ ุงููููู: ${(r.interest*100).toFixed(0)}ูช</div>
        </div>
        <div>${tag}</div>
      </div>`;
    details.appendChild(row);
  });
}

// ุชุฑุฌูุฉ ุงุณู ุงููุญูุฑ ููุนุฑุจูุฉ
function axisToArabic(ax){
  const map = {
    stem:"ูููู STEM", math:"ุฑูุงุถูุงุช", physics:"ููุฒูุงุก", chemistry:"ููููุงุก",
    coding:"ุจุฑูุฌุฉ", systems:"ุฃูุธูุฉ/ุดุจูุงุช", problem:"ุญูู ุงููุดููุงุช", electronics:"ุฅููุชุฑูููุงุช",
    life:"ุนููู ุญูุงุชูุฉ", lab:"ูุฎุชุจุฑ", empathy:"ุชุนุงุทู", shift:"ููุงูุจุงุช",
    field:"ุนูู ููุฏุงูู", spatial:"ุญุณ ููุงูู", design:"ุชุตููู", tinkering:"ุชุฌุฑูุจ/ุชุตููุน",
    business:"ุฃุนูุงู/ุฅุฏุงุฑุฉ", office:"ููุชุจ", entrepreneurship:"ุฑูุงุฏุฉ", optimization:"ุชุญุณูู/ุชุดุบูู",
    language:"ูุบุฉ", media:"ุฅุนูุงู", law:"ูุงููู", religion:"ุดุฑุนู",
    education:"ุชุนููู", comm:"ุชูุงุตู", patience:"ุตุจุฑ",
    research:"ุจุญุซ ุนููู", environment:"ุจูุฆุฉ", tech:"ุชูููุงุช ุทุจูุฉ",
    ai:"ุฐูุงุก ุงุตุทูุงุนู", network:"ุดุจูุงุช/ุฃูู", anatomy:"ุชุดุฑูุญ", pharma:"ุตูุฏูุฉ/ุฏูุงุก",
    geospatial:"GIS/ุฌุบุฑุงููุง", publicSpeaking:"ุฎุทุงุจุฉ", history:"ุชุงุฑูุฎ/ุฅูุณุงููุงุช",
    arts:"ูููู", caregiving:"ุฑุนุงูุฉ", discipline:"ุงูุถุจุงุท"
  };
  return map[ax] || ax;
}

/* =======================
   ุญูุธ ูุงุณุชุฑุฌุงุน ูุญูู + ุฅุฑุณุงู ุงุฎุชูุงุฑู
   ======================= */
function saveLocal(){
  try{
    const payload = {
      name: document.getElementById('studentName').value.trim(),
      stream: document.getElementById('tawjihiStream').value,
      avg: document.getElementById('avg').value,
      fav: [...document.getElementById('fav').selectedOptions].map(o=>o.value),
      workEnv: document.getElementById('workEnv').value,
      notes: document.getElementById('notes').value,
      answers
    };
    localStorage.setItem('iugMajorAdvisor', JSON.stringify(payload));
  }catch(e){}
}

function loadLocal(){
  try{
    const s = JSON.parse(localStorage.getItem('iugMajorAdvisor')||'null');
    if (!s) return;
    document.getElementById('studentName').value = s.name||'';
    document.getElementById('tawjihiStream').value = s.stream||'ุนููู';
    document.getElementById('avg').value = s.avg||'';
    const fav = new Set(s.fav||[]);
    [...document.getElementById('fav').options].forEach(o=> o.selected = fav.has(o.value));
    document.getElementById('workEnv').value = s.workEnv||'ูุฎุชุจุฑุงุช';
    document.getElementById('notes').value = s.notes||'';
    Object.assign(answers, s.answers||{});
  }catch(e){}
}

// ุฅุฑุณุงู ุฅูู Google Apps Script ุงุฎุชูุงุฑููุง ุฅู ุนุฑููุชู window.ADVISOR_SCRIPT_URL
document.getElementById('btnSave').addEventListener('click', () => {
  try{
    if (!window.ADVISOR_SCRIPT_URL) { alert('ุชู ุงูุญูุธ ูุญูููุง. ูุชูููู ุงูุฅุฑุณุงู ุงูุฎุงุฑุฌูุ ุนุฑูููุง window.ADVISOR_SCRIPT_URL.'); return; }
    const payload = JSON.parse(localStorage.getItem('iugMajorAdvisor')||'{}');
    const fd = new FormData();
    fd.append('event','advisor_result');
    fd.append('payload', JSON.stringify(payload));
    (navigator.sendBeacon && navigator.sendBeacon(ADVISOR_SCRIPT_URL, fd)) || fetch(ADVISOR_SCRIPT_URL, { method:'POST', body:fd });
    alert('ุชู ุฅุฑุณุงู ุงูุงุณุชุดุงุฑุฉ ุจูุฌุงุญุ ุดูุฑูุง ูู!');
  }catch(e){ alert('ุชู ุงูุญูุธ ูุญูููุง.'); }
});

/* =======================
   ุชููุฆุฉ ุงูุตูุญุฉ
   ======================= */
function init() {
  autoFillNameFromSite();
  loadLocal();
  renderQuestion(currentIndex);
  updateCounters();
  // ุงุณุชูุงุน ูุชุบููุฑ ุงูุญููู ููุญูุธ ุงูููุฑู
  ['studentName','tawjihiStream','avg','workEnv','fav','notes'].forEach(id=>{
    const el = document.getElementById(id);
    el && el.addEventListener('change', saveLocal);
  });
}
document.addEventListener('DOMContentLoaded', init);
</script>
<script defer="True" src="assets/js/statusBar.js"></script>
</body>
</html>
