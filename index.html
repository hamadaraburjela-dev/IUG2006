<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>جامعة المعرفة | الصفحة الرئيسية</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&amp;display=swap" rel="stylesheet"/>
<link crossorigin="anonymous" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" referrerpolicy="no-referrer" rel="stylesheet"/>
<link href="assets/css/main.css" rel="stylesheet"/>
<link rel="icon" type="image/png" href="assets/images/favicon.png">

  <style>
  /* Hero card redesign (centered, rounded, soft shadow) */
  #landing-screen { display:flex; justify-content:center; }
  .hero-card {
    width: 100%;
    max-width: 920px;
    background: #fff;
    border-radius: 18px;
    padding: 36px 44px;
    box-shadow: 0 18px 40px rgba(2, 48, 32, 0.08);
    border: 6px solid #e8f3ee;
    text-align: center;
    margin: 24px 12px;
  }
  .hero-top .logo { width: 84px; height: auto; margin: 0 auto 8px; }
  .hero-title { color: var(--primary-dark, #0b5a3a); font-size: 30px; margin: 6px 0 6px; font-weight:700; }
  .hero-sub { color: #556b63; font-size: 14px; margin-bottom: 20px; }
  .info-card { background: #f6fbf9; border-radius: 12px; padding: 18px; margin: 18px auto; max-width:760px; color:#224d3a; box-shadow: inset 0 1px 0 rgba(255,255,255,0.6); }
  .features-grid { display:grid; grid-template-columns: repeat(3, 1fr); gap:18px; margin-top:18px; align-items: start; justify-items: stretch; }
  .feature-card { background:#fff; border-radius:12px; padding:20px; box-shadow: 0 6px 18px rgba(4,40,28,0.04); border:1px solid #eef6f1; text-align:center; width:100%; box-sizing:border-box; }
  /* ensure icons and headings inside cards don't overflow */
  .feature-card .icon { display:block; margin: 0 auto 10px; }
  .feature-card .icon { font-size:34px; display:block; margin-bottom:10px; }
  .main-cta { margin-top:26px; padding:16px 40px; border-radius:999px; font-size:18px; background: linear-gradient(180deg,#0a6b3e,#075836); color:#fff; box-shadow: 0 10px 30px rgba(5,75,45,0.18); border:none; }
  .reset-link-container { margin-top:14px; }
  @media (max-width:900px) { .features-grid { grid-template-columns: 1fr; } .hero-card{padding:22px} .hero-title{font-size:22px} }
  </style>
  <style>
  /* Form helper and error styles */
  .field-help { font-size: 0. nine rem; color: #556b63; opacity: 0.9; margin-top:6px; }
  .field-error { font-size: 0.95rem; color: #b22222; margin-top:6px; display:none; }
  .form-group { margin-bottom: 14px; }
  .action-button[disabled] { opacity: 0.6; cursor: not-allowed; }
  </style>

<meta content="مرحباً بكم في جامعة المعرفة – منصة تعليمية متكاملة تقدم أحدث البرامج الأكاديمية وخدمات للطلاب." name="description"/><meta content="جامعة المعرفة | الصفحة الرئيسية" property="og:title"/><meta content="مرحباً بكم في جامعة المعرفة – منصة تعليمية متكاملة تقدم أحدث البرامج الأكاديمية وخدمات للطلاب." property="og:description"/><meta content="/assets/images/arts-logo.webp" property="og:image"/><link href="https://fonts.googleapis.com" rel="preconnect"/><link crossorigin="True" href="https://fonts.gstatic.com" rel="preconnect"/><meta content="ar_AR" property="og:locale"/><meta content="summary_large_image" name="twitter:card"/><meta content="جامعة المعرفة | الصفحة الرئيسية" name="twitter:title"/><meta content="مرحباً بكم في جامعة المعرفة – منصة تعليمية متكاملة تقدم أحدث البرامج الأكاديمية وخدمات للطلاب." name="twitter:description"/><meta content="/assets/images/arts-logo.webp" name="twitter:image"/><link href="https://example.com/index.html" rel="canonical"/></head>
<body>
<audio id="correct-sound" preload="auto" src="assets/sounds/correct.mp3"></audio>
<audio id="incorrect-sound" preload="auto" src="assets/sounds/funny.mp3"></audio>
<audio id="transition-sound" preload="auto" src="assets/sounds/turning.mp3"></audio>
<audio id="guide-appears-sound" preload="auto" src="assets/sounds/guide_appears.mp3"></audio>

<div id="status-bar-placeholder"></div>
<div class="game-container">
<div id="landing-screen">
  <div class="hero-card">
    <div class="hero-top">
      <img class="logo" src="assets/images/logo.webp" alt="شعار الجامعة"/>
      <h2 class="hero-title">رحلتك نحو المعرفة والتميز تبدأ الآن</h2>
      <p class="hero-sub">منصة تفاعلية لطلبة الثانوية العامة — اجمع النقاط، اربح جوائز، وحوّل مجهودك إلى منح دراسية.</p>
    </div>

    <div class="info-card">كيف تفوز في المسابقة؟ أجب بدقة، اجمع نقاطًا، واحصل على فرص منحة حقيقية.</div>

    <div class="features-grid">
      <div class="feature-card"><span class="icon">🎓</span><h4>حوّلها إلى منحة</h4><p>استبدل نقاطك بمنح عند قبولك بالجامعة.</p></div>
      <div class="feature-card"><span class="icon">💰</span><h4>جوائز فورية</h4><p>مكافآت فورية على إجاباتك الصحيحة.</p></div>
      <div class="feature-card"><span class="icon">🏆</span><h4>تحديات ممتعة</h4><p>أسئلة مشوقة تساعدك لاختيار تخصصك.</p></div>
    </div>

    <button id="show-register-btn" class="main-cta">سجّل الآن وابدأ التحدي!</button>
    <p class="reset-link-container"><a href="#" id="reset-progress-btn">هل تريد بدء رحلة جديدة؟ (سيتم حذف التقدم الحالي)</a></p>
  </div>
</div>
<div class="hidden" id="start-screen">
<img alt="شعار الجامعة الإسلامية" class="logo" height="250" loading="lazy" src="assets/images/logo.webp" width="250"/>
<h1>أهلاً بك في رحلتك الافتراضية</h1>
<p>استكشف الجامعة الإسلامية بغزة أجب عن التحديات، واربح منحة دراسية حقيقية!</p>
<form id="player-form" novalidate>
  <div class="form-group">
    <label for="name">الاسم الكامل:</label>
    <input id="name" minlength="5" placeholder="مثال: محمد أحمد" required type="text"/>
    <div class="field-help">أدخل اسمك الكامل كما في الهوية؛ سنستخدمه على الشهادة.</div>
    <div id="error-name" class="field-error">الاسم يجب أن يكون 5 أحرف على الأقل.</div>
  </div>

  <div class="form-group">
    <label for="phone">رقم الجوال:</label>
    <input id="phone" pattern="^05[96][0-9]{7}$" placeholder="مثال: 059xxxxxxx" required type="tel"/>
    <div class="field-help">أدخل رقم جوالك لنتواصل معك ولتفعيل بعض الخدمات (مثال: 0591234567).</div>
    <div id="error-phone" class="field-error">رقم الجوال غير صحيح؛ يجب أن يبدأ بـ 059/056 ويتبعه 7 أرقام.</div>
  </div>

  <div class="form-group">
    <label for="tawjihi-year">سنة التوجيهي:</label>
    <input id="tawjihi-year" min="2000" max="2026" placeholder="مثال: 2024" required type="number"/>
    <div class="field-help">سنستخدم سنة التوجيهي للمساعدة في إظهار التحديات المناسبة لسنتك.</div>
    <div id="error-year" class="field-error">أدخل سنة صحيحة بين 2000 و2026.</div>
  </div>

  <button class="action-button" id="start-button" disabled type="submit">ابدأ الرحلة!</button>
</form>

<script>
  (function(){
    const nameEl = document.getElementById('name');
    const phoneEl = document.getElementById('phone');
    const yearEl = document.getElementById('tawjihi-year');
    const startBtn = document.getElementById('start-button');

    function validateName(){
      const v = nameEl.value.trim();
      const ok = v.length >= 5;
      document.getElementById('error-name').style.display = ok ? 'none' : 'block';
      return ok;
    }
    function validatePhone(){
      const re = /^05[96][0-9]{7}$/;
      const ok = re.test(phoneEl.value.trim());
      document.getElementById('error-phone').style.display = ok ? 'none' : 'block';
      return ok;
    }
    function validateYear(){
      const y = parseInt(yearEl.value,10);
      const ok = Number.isFinite(y) && y >=2000 && y <= 2026;
      document.getElementById('error-year').style.display = ok ? 'none' : 'block';
      return ok;
    }

    function refresh(){
      const allOk = validateName() && validatePhone() && validateYear();
      startBtn.disabled = !allOk;
    }

    [nameEl, phoneEl, yearEl].forEach(el=>el.addEventListener('input', refresh));
    document.getElementById('player-form').addEventListener('submit', function(e){
      if (!validateName() || !validatePhone() || !validateYear()){
        e.preventDefault(); refresh();
        // focus first error
        if (!validateName()) nameEl.focus(); else if (!validatePhone()) phoneEl.focus(); else yearEl.focus();
      }
    });
  })();
</script>
</div>
<div class="game-stage hidden" id="guide-selection-screen">
<div class="scene-content">
<h2 class="scene-title">اختر مرشدك في الرحلة</h2><p>كل مرشد سيقدم لك نصائح من منظور تخصصه الفريد!</p>
<div class="guides-container"></div>
<button class="action-button" disabled="" id="confirm-guide-btn" style="margin-top: 30px;">تأكيد المرشد والبدء</button>
</div>
</div>
<div class="game-stage hidden" id="player-profile-scene">
<div class="scene-content" style="text-align: center;">
<h2 class="scene-title">الملف الشخصي للاعب</h2>
<div id="profile-emoji" style="font-size: 80px; margin-bottom: 15px;">👤</div>
<h3 id="profile-name" style="font-size: 24px; color: var(--primary-dark); margin-bottom: 20px;"></h3>
<div style="display: flex; justify-content: center; gap: 20px; font-size: 18px; flex-wrap: wrap; margin-bottom: 20px;">
<div class="feature-card" style="width: auto; padding: 15px 25px;">
<strong>النقاط:</strong> <span id="profile-score">0 نقطة</span>
</div>
<div class="feature-card" style="width: auto; padding: 15px 25px;">
<strong>سنة التوجيهي:</strong> <span id="profile-tawjihi-year"></span>
</div>
</div>
<div class="badges-section">
<h3 class="badges-title">الشارات المكتسبة</h3>
<div class="badges-container" id="badges-container">
</div>
</div>
<button class="action-button" id="profile-back-btn" style="margin-top: 30px;">العودة إلى اللعبة</button>
</div>
</div>
<div class="hidden" id="game-scene">
<button class="hidden" id="start-gate-quiz-btn"></button>
<div class="game-stage hidden" id="map-scene">
<div class="scene-content">
    <div class="map-container">
<h2 class="scene-title">خريطة الجامعة</h2>
<p>لقد دخلت الحرم الجامعي! اختر وجهتك التالية لاستكمال رحلتك.</p>
<div class="options-container">
<button class="option-btn" onclick="window.location.href='library.html'"><span class="map-icon">📚</span> المكتبة المركزية</button>
<span class="stage-points-pill" data-stage-points="library"></span>
<button class="option-btn" onclick="window.location.href='advisor.html'"><span class="map-icon">🧭</span>المستشار الذكي للتخصصات</button>
<span class="stage-points-pill" data-stage-points="advisor"></span>
<button class="option-btn" onclick="window.location.href='admission.html'"><span class="map-icon">📝</span> القبول والتسجيل</button>
<span class="stage-points-pill" data-stage-points="admission"></span>
<button class="option-btn" onclick="window.location.href='studentaffairs.html'"><span class="map-icon">🧑‍🎓</span> شؤون الطلبة</button>
<span class="stage-points-pill" data-stage-points="studentaffairs"></span>
<button class="option-btn" onclick="window.location.href='faculties.html'"><span class="map-icon">🏢</span> الكليات</button>
<span class="stage-points-pill" data-stage-points="faculties"></span>
<button class="option-btn" onclick="window.location.href='grants.html'"><span class="map-icon">💰</span> المنح والمساعدات</button>
<span class="stage-points-pill" data-stage-points="grants"></span>
<button class="option-btn" onclick="window.location.href='degree-certification.html'"><span class="map-icon">🏛️</span> قاعة المؤتمرات</button>
<span class="stage-points-pill" data-stage-points="degree-certification"></span>
<button class="option-btn" onclick="window.location.href='hospital.html'"><span class="map-icon">🏥</span> المستشفى الجامعي</button>
<span class="stage-points-pill" data-stage-points="hospital"></span>
<button class="option-btn" onclick="window.location.href='cafeteria.html'"><span class="map-icon">☕</span> الكافتيريا</button>
<span class="stage-points-pill" data-stage-points="cafeteria"></span>
<button class="option-btn" onclick="window.location.href='exchange.html'"><span class="map-icon">🌍</span> التبادل الأكاديمي</button>
<span class="stage-points-pill" data-stage-points="exchange"></span>
<button class="option-btn" onclick="window.location.href='certificate.html'"><span class="map-icon">📜</span> الحصول على الشهادة</button>
<span class="stage-points-pill" data-stage-points="certificate"></span>
</div>
</div>
</div>
<div class="game-stage hidden" id="end-scene">
<div class="scene-content">
<div class="certificate">
<div class="cert-header">
<img alt="شعار الجامعة الإسلامية" class="cert-logo" height="250" loading="lazy" src="assets/images/logo.webp" width="250"/>
<h2>شهادة إتمام رحلة</h2>
<h1>"رحلتي في الإسلامية"</h1>
</div>
<div class="cert-body">
<p>تشهد الجامعة الإسلامية بغزة بأن</p>
<h3 id="cert-player-name">[اسم الطالب هنا]</h3>
<p>قد أتم/ ت بنجاح رحلته التعريفية بالجامعة، وأظهر/ ت معرفة ممتازة بمرافقها وكلياتها المختلفة.</p>
<div class="cert-score">
<span>النقاط المكتسبة</span>
<strong id="cert-final-score">0</strong>
</div>
</div>
<div class="cert-footer">
<p>نتمنى لك مستقبلاً باهراً!</p>
</div>
</div>
<div class="end-scene-actions">
<p>شارك إنجازك مع أصدقائك!</p>
<div class="share-buttons">
<a class="share-btn facebook" href="#" id="share-facebook" target="_blank"><i class="fab fa-facebook-f"></i></a>
<a class="share-btn whatsapp" href="#" id="share-whatsapp" target="_blank"><i class="fab fa-whatsapp"></i></a>
<a class="share-btn twitter" href="#" id="share-twitter" target="_blank"><i class="fab fa-twitter"></i></a>
</div>
<a class="action-button community-btn" href="https://t.me/your_telegram_group_link" rel="noopener noreferrer" target="_blank">
<i class="fab fa-telegram-plane"></i> انضم لمجتمع الطلبة الجدد
                        </a>
<button class="action-button secondary-btn" id="new-player-btn">بدء رحلة جديدة (لاعب جديد)</button>
</div>
</div>
</div>
</div>
<div class="modal-container" id="quiz-modal">
<div class="modal-content">
<div class="modal-header"><h2 id="quiz-title">عنوان الاختبار</h2><button aria-label="إغلاق" class="close-button" id="close-quiz-modal-btn">×</button></div>
<div id="quiz-body"></div>
</div>
</div>
<div class="feedback-popup-container" id="feedback-popup">
<div class="feedback-popup-content">
<div class="feedback-progress-bar"></div><span id="feedback-emoji">✅</span><p id="feedback-message">إجابة رائعة!</p><p id="feedback-hint"></p>
</div>
</div>
<div class="modal hidden" id="feedback-modal">
<div class="modal-content"><h2 id="modal-title"></h2><div id="modal-text"></div><button class="action-button" id="modal-close-btn">متابعة</button></div>
</div>
<div class="modal hidden" id="logout-confirm-modal">
<div class="modal-content">
<h2>تأكيد الخروج</h2><p>هل أنت متأكد أنك تريد بدء رحلة جديدة؟ سيتم حذف كل تقدمك الحالي.</p>
<div class="modal-actions"><button class="action-button danger" id="confirm-logout-btn">نعم، اخرج</button><button class="action-button secondary" id="cancel-logout-btn">لا، ابقَ هنا</button></div>
</div>
</div>
<div class="modal hidden" id="video-overlay">
<video id="welcome-video" preload="metadata"><source src="assets/media/hares-1.mp4" type="video/mp4"/>متصفحك لا يدعم عرض الفيديو.</video>
<button class="action-button" id="skip-video-btn">تخطي الفيديو</button>
</div>
<div class="modal hidden" id="logout-confirm-modal">
<div class="modal-content">
<h2>تأكيد الخروج</h2>
<p>هل أنت متأكد أنك تريد بدء رحلة جديدة؟ سيتم حذف كل تقدمك الحالي.</p>
<div class="modal-actions">
<button class="action-button danger" id="confirm-logout-btn">نعم، اخرج</button>
<button class="action-button secondary" id="cancel-logout-btn">لا، ابقَ هنا</button>
<!-- مودال المحاولات -->
<div id="odv-modal" class="odv-modal" hidden>
  <div class="odv-modal__overlay" data-close></div>
  <div class="odv-modal__dialog" dir="rtl">
    <button class="odv-modal__close" type="button" data-close>×</button>
    <div class="odv-modal__icon" id="odv-modal-icon"></div>
    <h2 class="odv-modal__title" id="odv-modal-title">لقد أكملت جميع المحاولات</h2>
    <p class="odv-modal__desc" id="odv-modal-desc">لا مزيد من المحاولات المسموح بها.</p>
    <div class="odv-modal__actions">
      <button id="odv-modal-ok" class="odv-btn odv-btn--primary" type="button">حسنًا</button>
    </div>
  </div>
</div>
</div>
</div>
</div>
<div id="toast-notification"></div>
    <!-- Visual & audio small enhancements -->
  <style>
  /* subtle entrance animation */
  @keyframes floatIn { from { opacity: 0; transform: translateY(12px) scale(.995); } to { opacity:1; transform: translateY(0) scale(1); } }
  .hero-card { animation: floatIn 560ms cubic-bezier(.22,.9,.32,1) both; }
  .feature-card { transition: transform .28s ease, box-shadow .28s ease; }
  .feature-card:hover { transform: translateY(-8px) scale(1.02); box-shadow: 0 18px 40px rgba(6,80,45,0.08); }
  .main-cta { transition: transform .18s ease, box-shadow .18s ease; }
  .main-cta:active { transform: translateY(2px) scale(.995); }
  .action-button:focus, .main-cta:focus { outline: 3px solid rgba(6,100,60,0.12); outline-offset: 4px; }
  /* subtle pulse on load for CTA to draw attention */
  @keyframes pulseCta { 0%{ box-shadow: 0 10px 30px rgba(5,75,45,0.16);}50%{box-shadow:0 16px 40px rgba(5,75,45,0.22);}100%{box-shadow:0 10px 30px rgba(5,75,45,0.16);} }
  .main-cta.pulse { animation: pulseCta 2200ms ease-in-out 600ms infinite; }

  /* --- Prominent registration button styling (ripple + glow) --- */
  .ripple-btn { position: relative; overflow: hidden; -webkit-tap-highlight-color: transparent; }
  .ripple-btn.ripple-glow { transform: translateY(-2px) scale(1.01); box-shadow: 0 14px 36px rgba(7,96,59,0.18), 0 0 0 6px rgba(7,96,59,0.06); transition: box-shadow .36s ease, transform .12s ease; }
  .ripple-btn:focus { outline: none; box-shadow: 0 0 0 6px rgba(7,96,59,0.12); }

  /* ripple element */
  .ripple { position: absolute; border-radius: 50%; pointer-events: none; transform: scale(0); opacity: 0.9; background: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.95), rgba(255,255,255,0.55)); }
  @keyframes rippleAnim { to { transform: scale(1); opacity: 0; } }
  .ripple-animate { animation: rippleAnim 560ms cubic-bezier(.2,.8,.25,1) forwards; }

  /* subtle soft halo using pseudo-element for larger emphasis on hover/focus */
  .ripple-btn::after { content: ''; position: absolute; inset: -6px; border-radius: 999px; pointer-events: none; transition: opacity .28s ease, filter .28s ease; opacity: 0; filter: blur(8px); }
  .ripple-btn.ripple-glow::after { opacity: 1; background: linear-gradient(90deg, rgba(10,107,62,0.06), rgba(6,80,45,0.04)); }

  /* ensure ripple inside rounded pill doesn't overflow visually */
  .main-cta.ripple-btn { border-radius: 999px; }

  </style>

    <script>
    // Lightweight audio unlocking and UI sounds. Uses existing audio elements in the page.
    (function(){
      let unlocked = false;
      const clickAudio = document.getElementById('transition-sound');
      const guideAudio = document.getElementById('guide-appears-sound');
      // set gentle volumes
      if (clickAudio) clickAudio.volume = 0.24;
      if (guideAudio) guideAudio.volume = 0.18;

      function unlockAudioOnce(){
        if (unlocked) return;
        unlocked = true;
        try {
          // small play/pause to unlock on browsers that require gesture
          if (guideAudio) {
            guideAudio.play().then(()=>{ guideAudio.pause(); guideAudio.currentTime = 0; }).catch(()=>{});
          }
        } catch(e){}
        document.removeEventListener('pointerdown', unlockAudioOnce);
      }

      document.addEventListener('pointerdown', unlockAudioOnce, { once: true });

      // play click sound on primary interactions
      function playClick(){ if (clickAudio) { try { clickAudio.currentTime = 0; clickAudio.play().catch(()=>{}); } catch(e){} } }

      // wire buttons and CTA
      document.addEventListener('DOMContentLoaded', ()=>{
        // add pulse to CTA briefly
        const cta = document.querySelector('.main-cta');
        if (cta) { cta.classList.add('pulse'); setTimeout(()=>cta.classList.remove('pulse'), 5000); }

        document.querySelectorAll('.main-cta, .action-button, .feature-card, .share-btn').forEach(el=>{
          el.addEventListener('click', (e)=>{ playClick(); });
          // small pointer feedback for touch devices
          el.addEventListener('pointerdown', ()=>{ el.style.transform = 'translateY(1px)'; setTimeout(()=>el.style.transform='',160); });
        });

        // friendly hover sound for feature cards (pointerenter, but only on pointer devices)
        document.querySelectorAll('.feature-card').forEach(card=>{
          card.addEventListener('pointerenter', (ev)=>{
            if (ev.pointerType === 'mouse') return; // avoid playing on hover via mouse
            playClick();
          });
        });
      });
    })();
    </script>

    <script>
    // Visual ripple + glow for registration buttons (main CTA and form start button)
    (function(){
      function createRipple(e){
        const btn = this;
        const rect = btn.getBoundingClientRect();
        const size = Math.max(rect.width, rect.height) * 1.6;
        const ripple = document.createElement('span');
        ripple.className = 'ripple ripple-animate';
        ripple.style.width = ripple.style.height = size + 'px';
        // compute coordinates relative to button
        const left = (e.clientX - rect.left) - size/2;
        const top = (e.clientY - rect.top) - size/2;
        ripple.style.left = left + 'px';
        ripple.style.top = top + 'px';
        btn.appendChild(ripple);
        // glow class
        btn.classList.add('ripple-glow');
        setTimeout(()=>{ btn.classList.remove('ripple-glow'); }, 700);
        // cleanup
        setTimeout(()=>{ try{ ripple.remove(); }catch(e){} }, 700);
      }

      document.addEventListener('DOMContentLoaded', ()=>{
        const sel = '#show-register-btn, #start-button';
        document.querySelectorAll(sel).forEach(btn=>{
          // ensure visual container and accessibility
          btn.classList.add('ripple-btn');
          btn.setAttribute('aria-pressed', 'false');
          btn.addEventListener('click', createRipple);
          // keyboard-triggered activation: simulate center ripple
          btn.addEventListener('keydown', function(ev){ if (ev.key === 'Enter' || ev.key === ' ') { const fake = { clientX: btn.getBoundingClientRect().left + btn.offsetWidth/2, clientY: btn.getBoundingClientRect().top + btn.offsetHeight/2 }; createRipple.call(btn, fake); } });
        });
      });
    })();
    </script>

    <style>
    /* Guide selection visuals */
    #guide-selection-screen .scene-content { position: relative; }
  .guides-container { display: grid; grid-template-columns: repeat(auto-fit,minmax(160px,1fr)); gap:22px; margin-top:18px; align-items: start; justify-items: center; }
  .guide-card { background: #fff; width: 180px; border-radius: 12px; padding: 16px; text-align: center; box-shadow: 0 8px 20px rgba(10,40,30,0.06); border: 1px solid rgba(14,64,45,0.06); cursor: pointer; transition: transform .28s ease, box-shadow .28s ease, border-color .18s; position: relative; overflow: hidden; }
    .guide-card .guide-icon { font-size: 34px; display:block; margin: 0 auto 8px; }
  .guide-card:hover { transform: translateY(-6px) scale(1.01); box-shadow: 0 18px 40px rgba(6,80,45,0.08); }
  .guide-card.selected { border-color: #0a6b3e; box-shadow: 0 22px 48px rgba(6,100,60,0.12); transform: translateY(-4px) scale(1.01); z-index: 4; }

    /* check badge */
  .guide-card .check { position: absolute; inset-block-start: 12px; inset-inline-end: 12px; right: 12px; top: 12px; width: 36px; height: 36px; border-radius: 18px; display:flex; align-items:center; justify-content:center; background: linear-gradient(180deg,#0ba76a,#07824f); color:#fff; box-shadow: 0 6px 18px rgba(7,80,50,0.14); transform: scale(0.2); opacity: 0; transition: transform .28s cubic-bezier(.2,.9,.3,1), opacity .28s; z-index: 6; }
    .guide-card.selected .check { transform: scale(1); opacity: 1; }

    /* entrance animation */
    @keyframes slideUpFade { from { opacity: 0; transform: translateY(18px) scale(.995); } to { opacity: 1; transform: translateY(0) scale(1); } }
    .stagger-in { opacity: 0; transform: translateY(18px); }
    .stagger-in.play { animation: slideUpFade 420ms cubic-bezier(.22,.9,.32,1) forwards; }

    /* sound toggle */
    .sound-toggle { position: absolute; left: 18px; top: 12px; background: transparent; border: none; display:flex; gap:8px; align-items:center; padding:6px 10px; border-radius:999px; color:#144; cursor:pointer; }
    .sound-toggle .icon { font-size: 18px; }
    .sound-toggle[aria-pressed='true'] { opacity: 0.6; }
    </style>

    <script>
    // Guide selection: visual selection + sound + staggered entrance + mute toggle
    (function(){
      const containerSel = '.guides-container';
      const screen = document.getElementById('guide-selection-screen');
      const confirmBtn = document.getElementById('confirm-guide-btn');
      const guideSound = document.getElementById('guide-appears-sound') || document.getElementById('transition-sound');
      let muted = localStorage.getItem('iug-sound-muted') === '1';

      function setMuted(val){ muted = !!val; localStorage.setItem('iug-sound-muted', muted ? '1' : '0'); document.querySelectorAll('audio').forEach(a=>{ a.muted = muted; }); }
      setMuted(muted);

      function ensureSoundToggle(){
        if (!screen) return;
        const content = screen.querySelector('.scene-content');
        if (!content) return;
        if (content.querySelector('.sound-toggle')) return; // already exists
        const btn = document.createElement('button');
        btn.className = 'sound-toggle';
        btn.type = 'button';
        btn.setAttribute('aria-pressed', muted ? 'true' : 'false');
        btn.title = muted ? 'إلغاء كتم الصوت' : 'كتم الأصوات';
        btn.innerHTML = `<span class="icon">${muted ? '🔈' : '🔊'}</span><span class="label">${muted ? 'مكتوم' : 'صوت'}</span>`;
        btn.addEventListener('click', ()=>{ setMuted(!muted); btn.setAttribute('aria-pressed', muted ? 'true' : 'false'); btn.innerHTML = `<span class="icon">${muted ? '🔈' : '🔊'}</span><span class="label">${muted ? 'مكتوم' : 'صوت'}</span>`; });
        content.appendChild(btn);
      }

      function enableConfirmIfSelected(){
        const sel = document.querySelector('.guide-card.selected');
        if (confirmBtn) confirmBtn.disabled = !sel;
      }

      function onCardClick(card){
        // single-select behavior
        document.querySelectorAll('.guide-card').forEach(c=>c.classList.remove('selected'));
        card.classList.add('selected');
        // play sound
        try{ if (guideSound && !muted){ guideSound.currentTime = 0; guideSound.play().catch(()=>{}); } }catch(e){}
        enableConfirmIfSelected();
      }

      function attachCardHandlers(root){
        const cards = Array.from((root || document).querySelectorAll('.guide-card'));
        cards.forEach((card,i)=>{
          // add check badge if missing
          if (!card.querySelector('.check')){
            const chk = document.createElement('div'); chk.className = 'check'; chk.innerHTML = '✓'; card.appendChild(chk);
          }
          // ensure icon class
          if (!card.classList.contains('stagger-in')) card.classList.add('stagger-in');
          card.removeEventListener('click', card._guideClick);
          card._guideClick = ()=> onCardClick(card);
          card.addEventListener('click', card._guideClick);
        });

        // staggered reveal
        cards.forEach((c,i)=>{ setTimeout(()=>{ c.classList.add('play'); }, i * 70); });
      }

      // observe container for dynamically added cards
      function observeContainer(){
        const container = document.querySelector(containerSel);
        if (!container) return;
        attachCardHandlers(container);
        const mo = new MutationObserver((mut)=>{ attachCardHandlers(container); });
        mo.observe(container, { childList: true, subtree: true });
      }

      document.addEventListener('DOMContentLoaded', ()=>{
        ensureSoundToggle();
        observeContainer();
        enableConfirmIfSelected();
      });
    })();
    </script>

    <script defer="True" src="assets/js/statusBar.js"></script>
<script defer="True" src="assets/js/script.js"></script>
<script defer="True" src="assets/js/quiz-logic.js"></script>
<script defer="True" src="assets/js/common-fixes.js"></script>
<script defer="True" src="assets/js/faculty-page.js"></script>

</body>
</html>